<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model constructors · MixedModels</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MixedModels logo"/></a><div class="docs-package-name"><span class="docs-autofit">MixedModels</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MixedModels.jl Documentation</a></li><li class="is-active"><a class="tocitem" href>Model constructors</a><ul class="internal"><li><a class="tocitem" href="#Examples-of-linear-mixed-effects-model-fits-1"><span>Examples of linear mixed-effects model fits</span></a></li><li><a class="tocitem" href="#Fitting-generalized-linear-mixed-models-1"><span>Fitting generalized linear mixed models</span></a></li><li class="toplevel"><a class="tocitem" href="#Extractor-functions-1"><span>Extractor functions</span></a></li><li><a class="tocitem" href="#Model-fit-statistics-1"><span>Model-fit statistics</span></a></li><li><a class="tocitem" href="#Fixed-effects-parameter-estimates-1"><span>Fixed-effects parameter estimates</span></a></li><li><a class="tocitem" href="#Covariance-parameter-estimates-1"><span>Covariance parameter estimates</span></a></li><li><a class="tocitem" href="#Conditional-modes-of-the-random-effects-1"><span>Conditional modes of the random effects</span></a></li><li><a class="tocitem" href="#Case-wise-diagnostics-and-residual-degrees-of-freedom-1"><span>Case-wise diagnostics and residual degrees of freedom</span></a></li></ul></li><li><a class="tocitem" href="../optimization/">Details of the parameter estimation</a></li><li><a class="tocitem" href="../GaussHermite/">Normalized Gauss-Hermite Quadrature</a></li><li><a class="tocitem" href="../bootstrap/">Parametric bootstrap for linear mixed-effects models</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Model constructors</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model constructors</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaStats/MixedModels.jl/blob/master/docs/src/constructors.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-constructors-1"><a class="docs-heading-anchor" href="#Model-constructors-1">Model constructors</a><a class="docs-heading-anchor-permalink" href="#Model-constructors-1" title="Permalink"></a></h1><p>The <code>LinearMixedModel</code> type represents a linear mixed-effects model. Typically it is constructed from a <code>Formula</code> and an appropriate <code>data</code> type, usually a <code>DataFrame</code>.</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.LinearMixedModel" href="#MixedModels.LinearMixedModel"><code>MixedModels.LinearMixedModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LinearMixedModel</code></pre><p>Linear mixed-effects model representation</p><p><strong>Fields</strong></p><ul><li><code>formula</code>: the formula for the model</li><li><code>allterms</code>: a vector of random-effects terms, the fixed-effects terms and the response</li><li><code>sqrtwts</code>: vector of square roots of the case weights.  Can be empty.</li><li><code>parmap</code> : Vector{NTuple{3,Int}} of (block, row, column) mapping of θ to λ</li><li><code>dims</code> : NamedTuple{(:n, :p, :nretrms),NTuple{3,Int}} of dimensions.  <code>p</code> is the rank of <code>X</code>, which may be smaller than <code>size(X, 2)</code>.</li><li><code>A</code>: an <code>nt × nt</code> symmetric <code>BlockMatrix</code> of matrices representing <code>hcat(Z,X,y)&#39;hcat(Z,X,y)</code></li><li><code>L</code>: a <code>nt × nt</code> <code>BlockMatrix</code> - the lower Cholesky factor of <code>Λ&#39;AΛ+I</code></li><li><code>optsum</code>: an <a href="../optimization/#MixedModels.OptSummary"><code>OptSummary</code></a> object</li></ul><p><strong>Properties</strong></p><ul><li><code>θ</code> or <code>theta</code>: the covariance parameter vector used to form λ</li><li><code>β</code> or <code>beta</code>: the fixed-effects coefficient vector</li><li><code>λ</code> or <code>lambda</code>: a vector of lower triangular matrices repeated on the diagonal blocks of <code>Λ</code></li><li><code>σ</code> or <code>sigma</code>: current value of the standard deviation of the per-observation noise</li><li><code>b</code>: random effects on the original scale, as a vector of matrices</li><li><code>reterms</code>: a <code>Vector{ReMat{T}}</code> of random-effects terms.</li><li><code>feterms</code>: a <code>Vector{FeMat{T}}</code> of the fixed-effects model matrix and the response</li><li><code>u</code>: random effects on the orthogonal scale, as a vector of matrices</li><li><code>lowerbd</code>: lower bounds on the elements of θ</li><li><code>X</code>: the fixed-effects model matrix</li><li><code>y</code>: the response vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/linearmixedmodel.jl#L1-L30">source</a></section></article><h2 id="Examples-of-linear-mixed-effects-model-fits-1"><a class="docs-heading-anchor" href="#Examples-of-linear-mixed-effects-model-fits-1">Examples of linear mixed-effects model fits</a><a class="docs-heading-anchor-permalink" href="#Examples-of-linear-mixed-effects-model-fits-1" title="Permalink"></a></h2><p>For illustration, several data sets from the <em>lme4</em> package for <em>R</em> are made available in <code>.feather</code> format in this package. These include the <code>Dyestuff</code> and <code>Dyestuff2</code> data sets.</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.dataset" href="#MixedModels.dataset"><code>MixedModels.dataset</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">dataset(nm)</code></pre><p>Return the data frame of test data set named <code>nm</code>, which can be a <code>String</code> or <code>Symbol</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/utilities.jl#L141-L145">source</a></section></article><pre><code class="language-julia">using Test</code></pre><pre><code class="language-julia">using MixedModels
using StatsBase: describe
dyestuff = MixedModels.dataset(:dyestuff)
describe(dyestuff)</code></pre><table class="data-frame"><thead><tr><th></th><th>variable</th><th>mean</th><th>min</th><th>median</th><th>max</th><th>nunique</th><th>nmissing</th><th>eltype</th></tr><tr><th></th><th>Symbol</th><th>Union…</th><th>Any</th><th>Union…</th><th>Any</th><th>Union…</th><th>Nothing</th><th>DataType</th></tr></thead><tbody><p>2 rows × 8 columns</p><tr><th>1</th><td>batch</td><td></td><td>A</td><td></td><td>F</td><td>6</td><td></td><td>String</td></tr><tr><th>2</th><td>yield</td><td>1527.5</td><td>1440</td><td>1530.0</td><td>1635</td><td></td><td></td><td>Int16</td></tr></tbody></table><h3 id="Models-with-simple,-scalar-random-effects-1"><a class="docs-heading-anchor" href="#Models-with-simple,-scalar-random-effects-1">Models with simple, scalar random effects</a><a class="docs-heading-anchor-permalink" href="#Models-with-simple,-scalar-random-effects-1" title="Permalink"></a></h3><p>The formula language in <em>Julia</em> is similar to that in <em>R</em> which is based on (Wilkinson and Rogers <a href="https://dx.doi.org/10.2307/2346786">1973</a>). In Julia a formula must be enclosed in a call to the <code>@formula</code> macro.</p><article class="docstring"><header><a class="docstring-binding" id="StatsModels.@formula" href="#StatsModels.@formula"><code>StatsModels.@formula</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@formula(ex)</code></pre><p>Capture and parse a formula expression as a <code>Formula</code> struct.</p><p>A formula is an abstract specification of a dependence between <em>left-hand</em> and <em>right-hand</em> side variables as in, e.g., a regression model.  Each side specifies at a high level how tabular data is to be converted to a numerical matrix suitable for modeling.  This specification looks something like Julia code, is represented as a Julia <code>Expr</code>, but uses special syntax.  The <code>@formula</code> macro takes an expression like <code>y ~ 1 + a*b</code>, transforms it according to the formula syntax rules into a lowered form (like <code>y ~ 1 + a + b + a&amp;b</code>), and constructs a <code>Formula</code> struct which captures the original expression, the lowered expression, and the left- and right-hand-side.</p><p>Operators that have special interpretations in this syntax are</p><ul><li><code>~</code> is the formula separator, where it is a binary operator (the first argument is the left-hand side, and the second is the right-hand side.</li><li><code>+</code> concatenates variables as columns when generating a model matrix.</li><li><code>&amp;</code> representes an <em>interaction</em> between two or more variables, which corresponds to a row-wise kronecker product of the individual terms (or element-wise product if all terms involved are continuous/scalar).</li><li><code>*</code> expands to all main effects and interactions: <code>a*b</code> is equivalent to <code>a+b+a&amp;b</code>, <code>a*b*c</code> to <code>a+b+c+a&amp;b+a&amp;c+b&amp;c+a&amp;b&amp;c</code>, etc.</li><li><code>1</code>, <code>0</code>, and <code>-1</code> indicate the presence (for <code>1</code>) or absence (for <code>0</code> and <code>-1</code>) of an intercept column.</li></ul><p>The rules that are applied are</p><ul><li>The associative rule (un-nests nested calls to <code>+</code>, <code>&amp;</code>, and <code>*</code>).</li><li>The distributive rule (interactions <code>&amp;</code> distribute over concatenation <code>+</code>).</li><li>The <code>*</code> rule expands <code>a*b</code> to <code>a+b+a&amp;b</code> (recursively).</li><li>Subtraction is converted to addition and negation, so <code>x-1</code> becomes <code>x + -1</code> (applies only to subtraction of literal 1).</li><li>Single-argument <code>&amp;</code> calls are stripped, so <code>&amp;(x)</code> becomes the main effect <code>x</code>.</li></ul></div></section></article><p>A basic model with simple, scalar random effects for the levels of <code>batch</code> (the batch of an intermediate product, in this case) is declared and fit as</p><pre><code class="language-julia">fm = @formula(yield ~ 1 + (1|batch))
fm1 = fit(MixedModel, fm, dyestuff)</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 yield ~ 1 + (1 | batch)
   logLik   -2 logLik     AIC        BIC    
 -163.66353  327.32706  333.32706  337.53065

Variance components:
            Column    Variance  Std.Dev. 
batch    (Intercept)  1388.3333 37.260345
Residual              2451.2500 49.510100
 Number of obs: 30; levels of grouping factors: 6

  Fixed-effects parameters:
────────────────────────────────────────────────
              Coef.  Std. Error      z  Pr(&gt;|z|)
────────────────────────────────────────────────
(Intercept)  1527.5     17.6946  86.33    &lt;1e-99
────────────────────────────────────────────────</code></pre><p>(If you are new to Julia you may find that this first fit takes an unexpectedly long time, due to Just-In-Time (JIT) compilation of the code. The subsequent calls to such functions are much faster.)</p><pre><code class="language-julia">using BenchmarkTools
dyestuff2 = MixedModels.dataset(:dyestuff2)
@benchmark fit(MixedModel, $fm, $dyestuff2)</code></pre><pre><code class="language-none">BenchmarkTools.Trial: 
  memory estimate:  65.05 KiB
  allocs estimate:  1377
  --------------
  minimum time:     515.143 μs (0.00% GC)
  median time:      569.048 μs (0.00% GC)
  mean time:        610.074 μs (4.56% GC)
  maximum time:     36.010 ms (94.43% GC)
  --------------
  samples:          8107
  evals/sample:     1</code></pre><p>By default, the model fit is by maximum likelihood. To use the <code>REML</code> criterion instead, add the optional named argument <code>REML=true</code> to the call to <code>fit</code></p><pre><code class="language-julia">fm1reml = fit(MixedModel, fm, dyestuff, REML=true)</code></pre><pre><code class="language-none">Linear mixed model fit by REML
 yield ~ 1 + (1 | batch)
 REML criterion at convergence: 319.6542768422538

Variance components:
            Column    Variance  Std.Dev. 
batch    (Intercept)  1764.0506 42.000602
Residual              2451.2499 49.510099
 Number of obs: 30; levels of grouping factors: 6

  Fixed-effects parameters:
────────────────────────────────────────────────
              Coef.  Std. Error      z  Pr(&gt;|z|)
────────────────────────────────────────────────
(Intercept)  1527.5     19.3834  78.80    &lt;1e-99
────────────────────────────────────────────────</code></pre><h3 id="Simple,-scalar-random-effects-1"><a class="docs-heading-anchor" href="#Simple,-scalar-random-effects-1">Simple, scalar random effects</a><a class="docs-heading-anchor-permalink" href="#Simple,-scalar-random-effects-1" title="Permalink"></a></h3><p>A simple, scalar random effects term in a mixed-effects model formula is of the form <code>(1|G)</code>. All random effects terms end with <code>|G</code> where <code>G</code> is the <em>grouping factor</em> for the random effect. The name or, more generally, the expression <code>G</code> should evaluate to a categorical array that has a distinct set of <em>levels</em>. The random effects are associated with the levels of the grouping factor.</p><p>A <em>scalar</em> random effect is, as the name implies, one scalar value for each level of the grouping factor. A <em>simple, scalar</em> random effects term is of the form, <code>(1|G)</code>. It corresponds to a shift in the intercept for each level of the grouping factor.</p><h3 id="Models-with-vector-valued-random-effects-1"><a class="docs-heading-anchor" href="#Models-with-vector-valued-random-effects-1">Models with vector-valued random effects</a><a class="docs-heading-anchor-permalink" href="#Models-with-vector-valued-random-effects-1" title="Permalink"></a></h3><p>The <em>sleepstudy</em> data are observations of reaction time, <code>reaction</code>, on several subjects, <code>subj</code>, after 0 to 9 days of sleep deprivation, <code>days</code>. A model with random intercepts and random slopes for each subject, allowing for within-subject correlation of the slope and intercept, is fit as</p><pre><code class="language-julia">sleepstudy = MixedModels.dataset(:sleepstudy)
fm2 = fit(MixedModel, @formula(reaction ~ 1 + days + (1 + days|subj)), sleepstudy)</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 reaction ~ 1 + days + (1 + days | subj)
   logLik   -2 logLik     AIC        BIC    
 -875.96967 1751.93934 1763.93934 1783.09709

Variance components:
            Column    Variance   Std.Dev.    Corr.
subj     (Intercept)  565.510678 23.7804684
         days          32.682124  5.7168282 +0.08
Residual              654.941447 25.5918238
 Number of obs: 180; levels of grouping factors: 18

  Fixed-effects parameters:
──────────────────────────────────────────────────
                Coef.  Std. Error      z  Pr(&gt;|z|)
──────────────────────────────────────────────────
(Intercept)  251.405      6.63226  37.91    &lt;1e-99
days          10.4673     1.50224   6.97    &lt;1e-11
──────────────────────────────────────────────────</code></pre><h3 id="Models-with-multiple,-scalar-random-effects-terms-1"><a class="docs-heading-anchor" href="#Models-with-multiple,-scalar-random-effects-terms-1">Models with multiple, scalar random-effects terms</a><a class="docs-heading-anchor-permalink" href="#Models-with-multiple,-scalar-random-effects-terms-1" title="Permalink"></a></h3><p>A model for the <em>Penicillin</em> data incorporates random effects for the plate, and for the sample. As every sample is used on every plate these two factors are <em>crossed</em>.</p><pre><code class="language-julia">penicillin = MixedModels.dataset(:penicillin)
fm3 = fit(MixedModel, @formula(diameter ~ 1 + (1|plate) + (1|sample)), penicillin)</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 diameter ~ 1 + (1 | plate) + (1 | sample)
   logLik   -2 logLik     AIC        BIC    
 -166.09417  332.18835  340.18835  352.06760

Variance components:
            Column    Variance   Std.Dev. 
plate    (Intercept)  0.71497945 0.8455646
sample   (Intercept)  3.13519425 1.7706480
Residual              0.30242640 0.5499331
 Number of obs: 144; levels of grouping factors: 24, 6

  Fixed-effects parameters:
─────────────────────────────────────────────────
               Coef.  Std. Error      z  Pr(&gt;|z|)
─────────────────────────────────────────────────
(Intercept)  22.9722    0.744596  30.85    &lt;1e-99
─────────────────────────────────────────────────</code></pre><p>In contrast the <code>sample</code> grouping factor is <em>nested</em> within the <code>batch</code> grouping factor in the <em>Pastes</em> data. That is, each level of <code>sample</code> occurs in conjunction with only one level of <code>batch</code>.</p><pre><code class="language-julia">pastes = MixedModels.dataset(:pastes)
describe(pastes)</code></pre><table class="data-frame"><thead><tr><th></th><th>variable</th><th>mean</th><th>min</th><th>median</th><th>max</th><th>nunique</th><th>nmissing</th><th>eltype</th></tr><tr><th></th><th>Symbol</th><th>Union…</th><th>Any</th><th>Union…</th><th>Any</th><th>Union…</th><th>Nothing</th><th>DataType</th></tr></thead><tbody><p>4 rows × 8 columns</p><tr><th>1</th><td>batch</td><td></td><td>A</td><td></td><td>J</td><td>10</td><td></td><td>String</td></tr><tr><th>2</th><td>cask</td><td></td><td>a</td><td></td><td>c</td><td>3</td><td></td><td>String</td></tr><tr><th>3</th><td>sample</td><td></td><td>A:a</td><td></td><td>J:c</td><td>30</td><td></td><td>String</td></tr><tr><th>4</th><td>strength</td><td>60.0533</td><td>54.2</td><td>59.3</td><td>66.0</td><td></td><td></td><td>Float64</td></tr></tbody></table><pre><code class="language-julia">fm4 = fit(MixedModel, @formula(strength ~ 1 + (1|sample) + (1|batch)), pastes)</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 strength ~ 1 + (1 | sample) + (1 | batch)
   logLik   -2 logLik     AIC        BIC    
 -123.99723  247.99447  255.99447  264.37184

Variance components:
            Column    Variance   Std.Dev.  
sample   (Intercept)  8.43361634 2.90406893
batch    (Intercept)  1.19918042 1.09507097
Residual              0.67800208 0.82340882
 Number of obs: 60; levels of grouping factors: 30, 10

  Fixed-effects parameters:
─────────────────────────────────────────────────
               Coef.  Std. Error      z  Pr(&gt;|z|)
─────────────────────────────────────────────────
(Intercept)  60.0533    0.642136  93.52    &lt;1e-99
─────────────────────────────────────────────────</code></pre><p>In observational studies it is common to encounter <em>partially crossed</em> grouping factors. For example, the <em>InstEval</em> data are course evaluations by students, <code>s</code>, of instructors, <code>d</code>. Additional covariates include the academic department, <code>dept</code>, in which the course was given and <code>service</code>, whether or not it was a service course.</p><pre><code class="language-julia">insteval = MixedModels.dataset(:insteval)
fm5 = fit(MixedModel, @formula(y ~ 1 + service * dept + (1|s) + (1|d)), insteval)</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 y ~ 1 + service + dept + service &amp; dept + (1 | s) + (1 | d)
     logLik        -2 logLik          AIC             BIC       
 -1.18792777×10⁵  2.37585553×10⁵  2.37647553×10⁵  2.37932876×10⁵

Variance components:
            Column     Variance   Std.Dev.  
s        (Intercept)  0.105417971 0.32468134
d        (Intercept)  0.258416365 0.50834670
Residual              1.384727773 1.17674457
 Number of obs: 73421; levels of grouping factors: 2972, 1128

  Fixed-effects parameters:
────────────────────────────────────────────────────────────────
                              Coef.  Std. Error      z  Pr(&gt;|z|)
────────────────────────────────────────────────────────────────
(Intercept)              3.27628      0.0793647  41.28    &lt;1e-99
service: Y               0.0116044    0.0699321   0.17    0.8682
dept: D02               -0.0411091    0.120331   -0.34    0.7326
dept: D03                0.00967413   0.108411    0.09    0.9289
dept: D04                0.105017     0.0944964   1.11    0.2664
dept: D05                0.0828643    0.11148     0.74    0.4573
dept: D06               -0.01194      0.0978342  -0.12    0.9029
dept: D07                0.0992679    0.110598    0.90    0.3694
dept: D08                0.0575337    0.127935    0.45    0.6529
dept: D09               -0.00263181   0.107085   -0.02    0.9804
dept: D10               -0.223423     0.099838   -2.24    0.0252
dept: D11                0.0129816    0.110639    0.12    0.9066
dept: D12                0.00503825   0.0944243   0.05    0.9574
dept: D14                0.0050827    0.109041    0.05    0.9628
dept: D15               -0.0466719    0.101942   -0.46    0.6471
service: Y &amp; dept: D02  -0.144352     0.0929527  -1.55    0.1204
service: Y &amp; dept: D03   0.0174078    0.0927237   0.19    0.8511
service: Y &amp; dept: D04  -0.0381262    0.0810901  -0.47    0.6382
service: Y &amp; dept: D05   0.0596632    0.123952    0.48    0.6303
service: Y &amp; dept: D06  -0.254044     0.080781   -3.14    0.0017
service: Y &amp; dept: D07  -0.151634     0.11157    -1.36    0.1741
service: Y &amp; dept: D08   0.0508942    0.112189    0.45    0.6501
service: Y &amp; dept: D09  -0.259448     0.0899448  -2.88    0.0039
service: Y &amp; dept: D10   0.25907      0.111369    2.33    0.0200
service: Y &amp; dept: D11  -0.276577     0.0819621  -3.37    0.0007
service: Y &amp; dept: D12  -0.0418489    0.0792928  -0.53    0.5977
service: Y &amp; dept: D14  -0.256742     0.0931016  -2.76    0.0058
service: Y &amp; dept: D15   0.24042      0.0982071   2.45    0.0144
────────────────────────────────────────────────────────────────</code></pre><h3 id="Simplifying-the-random-effect-correlation-structure-1"><a class="docs-heading-anchor" href="#Simplifying-the-random-effect-correlation-structure-1">Simplifying the random effect correlation structure</a><a class="docs-heading-anchor-permalink" href="#Simplifying-the-random-effect-correlation-structure-1" title="Permalink"></a></h3><p>MixedEffects.jl estimates not only the <em>variance</em> of the effects for each random effect level, but also the <em>correlation</em> between the random effects for different predictors. So, for the model of the <em>sleepstudy</em> data above, one of the parameters that is estimated is the correlation between each subject&#39;s random intercept (i.e., their baseline reaction time) and slope (i.e., their particular change in reaction time over days of sleep deprivation). In some cases, you may wish to simplify the random effects structure by removing these correlation parameters. This often arises when there are many random effects you want to estimate (as is common in psychological experiments with many conditions and covariates), since the number of random effects parameters increases as the square of the number of predictors, making these models difficult to estimate from limited data.</p><p>A model with uncorrelated random effects for the intercept and slope by subject is fit as</p><pre><code class="language-julia">fm2zerocorr = fit!(zerocorr!(LinearMixedModel(@formula(reaction ~ 1 + days + (1 + days|subj)), sleepstudy)))</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 reaction ~ 1 + days + (1 + days | subj)
   logLik   -2 logLik     AIC        BIC    
 -876.00163 1752.00326 1762.00326 1777.96804

Variance components:
            Column    Variance  Std.Dev.   Corr.
subj     (Intercept)  584.258971 24.17145
         days          33.632805  5.79938   .  
Residual              653.115782 25.55613
 Number of obs: 180; levels of grouping factors: 18

  Fixed-effects parameters:
──────────────────────────────────────────────────
                Coef.  Std. Error      z  Pr(&gt;|z|)
──────────────────────────────────────────────────
(Intercept)  251.405      6.70771  37.48    &lt;1e-99
days          10.4673     1.51931   6.89    &lt;1e-11
──────────────────────────────────────────────────</code></pre><pre><code class="language-julia">@testset &quot;ZeroCorr deepcopy&quot; begin
    fm2zerocorr_alt = fit!(zerocorr!(deepcopy(fm2)))
    @test deviance(fm2zerocorr) ≈ deviance(fm2zerocorr_alt) rtol = 6
    @test varest(fm2zerocorr) ≈ varest(fm2zerocorr_alt) rtol = 6
    @test collect(VarCorr(fm2zerocorr).σρ.subj.σ) ≈ collect(VarCorr(fm2zerocorr_alt).σρ.subj.σ) rtol = 6
    @test collect(VarCorr(fm2zerocorr).σρ.subj.ρ) ≈ collect(VarCorr(fm2zerocorr_alt).σρ.subj.ρ) rtol = 2
    @test collect(VarCorr(fm2zerocorr).s) ≈ collect(VarCorr(fm2zerocorr_alt).s) rtol = 6
end</code></pre><pre><code class="language-none">Test.DefaultTestSet(&quot;ZeroCorr deepcopy&quot;, Any[], 5, false)</code></pre><p>Note that the use of <code>zerocorr!</code> requires the model to be constructed, then altered to eliminate the correlation of the random effects, then fit with a call to the mutating function, <code>fit!</code>.</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.zerocorr!" href="#MixedModels.zerocorr!"><code>MixedModels.zerocorr!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">zerocorr!(m::LinearMixedModel[, trmnms::Vector{Symbol}])</code></pre><p>Rewrite the random effects specification for the grouping factors in <code>trmnms</code> to zero correlation parameter.</p><p>The default for <code>trmnms</code> is all the names of random-effects terms.</p><p>A random effects term is in the zero correlation parameter configuration when the off-diagonal elements of λ are all zero - hence there are no correlation parameters in that term being estimated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/linearmixedmodel.jl#L959-L968">source</a></section></article><p>The special syntax <code>zerocorr</code> can be applied to individual random effects terms inside the <code>@formula</code>:</p><pre><code class="language-julia">fm2zerocorr_fm = fit(MixedModel, @formula(reaction ~ 1 + days + zerocorr(1 + days|subj)), sleepstudy)</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 reaction ~ 1 + days + MixedModels.ZeroCorr((1 + days | subj))
   logLik   -2 logLik     AIC        BIC    
 -876.00163 1752.00326 1762.00326 1777.96804

Variance components:
            Column    Variance  Std.Dev.   Corr.
subj     (Intercept)  584.258971 24.17145
         days          33.632805  5.79938   .  
Residual              653.115782 25.55613
 Number of obs: 180; levels of grouping factors: 18

  Fixed-effects parameters:
──────────────────────────────────────────────────
                Coef.  Std. Error      z  Pr(&gt;|z|)
──────────────────────────────────────────────────
(Intercept)  251.405      6.70771  37.48    &lt;1e-99
days          10.4673     1.51931   6.89    &lt;1e-11
──────────────────────────────────────────────────</code></pre><p>Alternatively, correlations between parameters can be removed by including them as separate random effects terms:</p><pre><code class="language-julia">fit(MixedModel, @formula(reaction ~ 1 + days + (1|subj) + (0 + days|subj)), sleepstudy)</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 reaction ~ 1 + days + (1 | subj) + (0 + days | subj)
   logLik   -2 logLik     AIC        BIC    
 -876.00163 1752.00326 1762.00326 1777.96804

Variance components:
            Column    Variance  Std.Dev.   Corr.
subj     (Intercept)  584.258971 24.17145
         days          33.632805  5.79938   .  
Residual              653.115782 25.55613
 Number of obs: 180; levels of grouping factors: 18

  Fixed-effects parameters:
──────────────────────────────────────────────────
                Coef.  Std. Error      z  Pr(&gt;|z|)
──────────────────────────────────────────────────
(Intercept)  251.405      6.70771  37.48    &lt;1e-99
days          10.4673     1.51931   6.89    &lt;1e-11
──────────────────────────────────────────────────</code></pre><p>Note that it <strong>is</strong> necessary to explicitly block the inclusion of an intercept term by adding <code>0</code> in the random-effects term <code>(0+days|subj)</code>.</p><p>Finally, for predictors that are categorical, MixedModels.jl will estimate correlations between each level. Notice the large number of correlation parameters if we treat <code>days</code> as a categorical variable by giving it contrasts:</p><pre><code class="language-julia">fit(MixedModel, @formula(reaction ~ 1 + days + (1 + days|subj)), sleepstudy,
    contrasts = Dict(:days =&gt; DummyCoding()))</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 reaction ~ 1 + days + (1 + days | subj)
   logLik   -2 logLik     AIC        BIC    
 -805.99507 1611.99014 1743.99014 1954.72529

Variance components:
            Column     Variance   Std.Dev.   Corr.
subj     (Intercept)   949.180357 30.808771
         days: 1       491.935710 22.179624 -0.30
         days: 2       907.207651 30.119888 -0.57 +0.75
         days: 3      1261.458894 35.517023 -0.37 +0.72 +0.87
         days: 4      1480.291151 38.474552 -0.31 +0.58 +0.67 +0.91
         days: 5      2294.116672 47.896938 -0.25 +0.46 +0.45 +0.70 +0.85
         days: 6      3850.530186 62.052640 -0.27 +0.30 +0.48 +0.70 +0.77 +0.75
         days: 7      1807.564802 42.515465 -0.15 +0.22 +0.47 +0.50 +0.63 +0.64 +0.71
         days: 8      3154.859979 56.168140 -0.20 +0.28 +0.36 +0.56 +0.73 +0.90 +0.73 +0.74
         days: 9      3076.454599 55.465797 +0.05 +0.26 +0.16 +0.38 +0.59 +0.78 +0.38 +0.53 +0.86
Residual                21.040918  4.587038
 Number of obs: 180; levels of grouping factors: 18

  Fixed-effects parameters:
───────────────────────────────────────────────────
                 Coef.  Std. Error      z  Pr(&gt;|z|)
───────────────────────────────────────────────────
(Intercept)  256.652       7.34174  34.96    &lt;1e-99
days: 1        7.84395     5.4468    1.44    0.1498
days: 2        8.71009     7.26211   1.20    0.2304
days: 3       26.3402      8.50993   3.10    0.0020
days: 4       31.9976      9.19654   3.48    0.0005
days: 5       51.8667     11.3925    4.55    &lt;1e-5
days: 6       55.5265     14.7057    3.78    0.0002
days: 7       62.0988     10.137     6.13    &lt;1e-9
days: 8       79.9777     13.327     6.00    &lt;1e-8
days: 9       94.1994     13.1625    7.16    &lt;1e-12
───────────────────────────────────────────────────</code></pre><p>Separating the <code>1</code> and <code>days</code> random effects into separate terms removes the correlations between the intercept and the levels of <code>days</code>, but not between the levels themselves:</p><pre><code class="language-julia">fit(MixedModel, @formula(reaction ~ 1 + days + (1|subj) + (0 + days|subj)), sleepstudy,
    contrasts = Dict(:days =&gt; DummyCoding()))</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 reaction ~ 1 + days + (1 | subj) + (0 + days | subj)
   logLik   -2 logLik     AIC        BIC    
  -818.4571  1636.9141  1750.9141  1932.9127

Variance components:
            Column    Variance   Std.Dev.    Corr.
subj     (Intercept)   893.84370 29.8972189
         days: 1       413.18042 20.3268400   .  
         days: 2       801.87214 28.3173470   .   +0.76
         days: 3      1172.69578 34.2446460   .   +0.74 +0.88
         days: 4      1381.54878 37.1691913   .   +0.58 +0.67 +0.93
         days: 5      2202.94825 46.9355755   .   +0.45 +0.44 +0.70 +0.86
         days: 6      3748.10429 61.2217632   .   +0.28 +0.48 +0.69 +0.79 +0.75
         days: 7      1707.23725 41.3187276   .   +0.17 +0.43 +0.53 +0.59 +0.65 +0.72
         days: 8      3057.33700 55.2931912   .   +0.26 +0.34 +0.56 +0.73 +0.91 +0.73 +0.75
         days: 9      3021.16329 54.9651097   .   +0.25 +0.13 +0.39 +0.58 +0.79 +0.38 +0.53 +0.86
Residual                50.72569  7.1221968
 Number of obs: 180; levels of grouping factors: 18

  Fixed-effects parameters:
───────────────────────────────────────────────────
                 Coef.  Std. Error      z  Pr(&gt;|z|)
───────────────────────────────────────────────────
(Intercept)  256.652       7.24404  35.43    &lt;1e-99
days: 1        7.84395     5.34702   1.47    0.1424
days: 2        8.71009     7.08411   1.23    0.2189
days: 3       26.3402      8.41344   3.13    0.0017
days: 4       31.9976      9.07683   3.53    0.0004
days: 5       51.8667     11.3147    4.58    &lt;1e-5
days: 6       55.5265     14.6241    3.80    0.0001
days: 7       62.0988     10.0241    6.19    &lt;1e-9
days: 8       79.9777     13.2472    6.04    &lt;1e-8
days: 9       94.1994     13.1711    7.15    &lt;1e-12
───────────────────────────────────────────────────</code></pre><p>But using <code>zerocorr</code> on the individual terms (or <code>zerocorr!</code> on the constructed model object as above) does remove the correlations between the levels:</p><pre><code class="language-julia">fit(MixedModel, @formula(reaction ~ 1 + days + zerocorr(1 + days|subj)), sleepstudy,
    contrasts = Dict(:days =&gt; DummyCoding()))
fit(MixedModel, @formula(reaction ~ 1 + days + (1|subj) + zerocorr(0 + days|subj)), sleepstudy,
    contrasts = Dict(:days =&gt; DummyCoding()))</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 reaction ~ 1 + days + (1 | subj) + MixedModels.ZeroCorr((0 + days | subj))
   logLik   -2 logLik     AIC        BIC    
  -882.9138  1765.8276  1807.8276  1874.8797

Variance components:
            Column    Variance   Std.Dev.   Corr.
subj     (Intercept)   958.53953 30.960290
         days: 1         0.00000  0.000000   .  
         days: 2         0.00000  0.000000   .     .  
         days: 3         0.00000  0.000000   .     .     .  
         days: 4         0.00000  0.000000   .     .     .     .  
         days: 5       519.60973 22.794950   .     .     .     .     .  
         days: 6      1703.85583 41.277789   .     .     .     .     .     .  
         days: 7       608.70745 24.671997   .     .     .     .     .     .     .  
         days: 8      1273.06821 35.680081   .     .     .     .     .     .     .     .  
         days: 9      1754.13246 41.882365   .     .     .     .     .     .     .     .     .  
Residual               434.86676 20.853459
 Number of obs: 180; levels of grouping factors: 18

  Fixed-effects parameters:
───────────────────────────────────────────────────
                 Coef.  Std. Error      z  Pr(&gt;|z|)
───────────────────────────────────────────────────
(Intercept)  256.652       8.79838  29.17    &lt;1e-99
days: 1        7.84395     6.95115   1.13    0.2591
days: 2        8.71009     6.95115   1.25    0.2102
days: 3       26.3402      6.95115   3.79    0.0002
days: 4       31.9976      6.95115   4.60    &lt;1e-5
days: 5       51.8666      8.78554   5.90    &lt;1e-8
days: 6       55.5264     11.9573    4.64    &lt;1e-5
days: 7       62.0988      9.06287   6.85    &lt;1e-11
days: 8       79.9777     10.9108    7.33    &lt;1e-12
days: 9       94.1994     12.0735    7.80    &lt;1e-14
───────────────────────────────────────────────────</code></pre><h2 id="Fitting-generalized-linear-mixed-models-1"><a class="docs-heading-anchor" href="#Fitting-generalized-linear-mixed-models-1">Fitting generalized linear mixed models</a><a class="docs-heading-anchor-permalink" href="#Fitting-generalized-linear-mixed-models-1" title="Permalink"></a></h2><p>To create a GLMM representation</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.GeneralizedLinearMixedModel" href="#MixedModels.GeneralizedLinearMixedModel"><code>MixedModels.GeneralizedLinearMixedModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">GeneralizedLinearMixedModel</code></pre><p>Generalized linear mixed-effects model representation</p><p><strong>Fields</strong></p><ul><li><code>LMM</code>: a <a href="#MixedModels.LinearMixedModel"><code>LinearMixedModel</code></a> - the local approximation to the GLMM.</li><li><code>β</code>: the pivoted and possibly truncated fixed-effects vector</li><li><code>β₀</code>: similar to <code>β</code>. Used in the PIRLS algorithm if step-halving is needed.</li><li><code>θ</code>: covariance parameter vector</li><li><code>b</code>: similar to <code>u</code>, equivalent to <code>broadcast!(*, b, LMM.Λ, u)</code></li><li><code>u</code>: a vector of matrices of random effects</li><li><code>u₀</code>: similar to <code>u</code>.  Used in the PIRLS algorithm if step-halving is needed.</li><li><code>resp</code>: a <code>GlmResp</code> object</li><li><code>η</code>: the linear predictor</li><li><code>wt</code>: vector of prior case weights, a value of <code>T[]</code> indicates equal weights.</li></ul><p>The following fields are used in adaptive Gauss-Hermite quadrature, which applies only to models with a single random-effects term, in which case their lengths are the number of levels in the grouping factor for that term.  Otherwise they are zero-length vectors.</p><ul><li><code>devc</code>: vector of deviance components</li><li><code>devc0</code>: vector of deviance components at offset of zero</li><li><code>sd</code>: approximate standard deviation of the conditional density</li><li><code>mult</code>: multiplier</li></ul><p><strong>Properties</strong></p><p>In addition to the fieldnames, the following names are also accessible through the <code>.</code> extractor</p><ul><li><code>theta</code>: synonym for <code>θ</code></li><li><code>beta</code>: synonym for <code>β</code></li><li><code>σ</code> or <code>sigma</code>: common scale parameter (value is <code>NaN</code> for distributions without a scale parameter)</li><li><code>lowerbd</code>: vector of lower bounds on the combined elements of <code>β</code> and <code>θ</code></li><li><code>formula</code>, <code>trms</code>, <code>A</code>, <code>L</code>, and <code>optsum</code>: fields of the <code>LMM</code> field</li><li><code>X</code>: fixed-effects model matrix</li><li><code>y</code>: response vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/generalizedlinearmixedmodel.jl#L1-L38">source</a></section></article><p>the distribution family for the response, and possibly the link function, must be specified.</p><pre><code class="language-julia">verbagg = MixedModels.dataset(:verbagg)
verbaggform = @formula(r2 ~ 1 + anger + gender + btype + situ + mode + (1|subj) + (1|item));
gm1 = fit(MixedModel, verbaggform, verbagg, Bernoulli())</code></pre><pre><code class="language-none">Generalized Linear Mixed Model fit by maximum likelihood (nAGQ = 1)
  r2 ~ 1 + anger + gender + btype + situ + mode + (1 | subj) + (1 | item)
  Distribution: Bernoulli{Float64}
  Link: LogitLink()

  Deviance: 8135.8329

Variance components:
        Column    Variance   Std.Dev. 
subj (Intercept)  1.79347065 1.3392052
item (Intercept)  0.11715204 0.3422748

 Number of obs: 7584; levels of grouping factors: 316, 24

Fixed-effects parameters:
──────────────────────────────────────────────────────
                   Coef.  Std. Error       z  Pr(&gt;|z|)
──────────────────────────────────────────────────────
(Intercept)   -0.153108    0.385221    -0.40    0.6910
anger          0.0573997   0.0167527    3.43    0.0006
gender: M      0.32076     0.191206     1.68    0.0934
btype: scold  -1.0598      0.184161    -5.75    &lt;1e-8
btype: shout  -2.10385     0.186519   -11.28    &lt;1e-28
situ: self    -1.05436     0.151196    -6.97    &lt;1e-11
mode: want     0.707002    0.151009     4.68    &lt;1e-5
──────────────────────────────────────────────────────</code></pre><p>The canonical link, which is <code>LogitLink</code> for the <code>Bernoulli</code> distribution, is used if no explicit link is specified.</p><p>Note that, in keeping with convention in the <a href="https://github.com/JuliaStats/GLM.jl"><code>GLM</code> package</a>, the distribution family for a binary (i.e. 0/1) response is the <code>Bernoulli</code> distribution. The <code>Binomial</code> distribution is only used when the response is the fraction of trials returning a positive, in which case the number of trials must be specified as the case weights.</p><h3 id="Optional-arguments-to-fit!-1"><a class="docs-heading-anchor" href="#Optional-arguments-to-fit!-1">Optional arguments to fit!</a><a class="docs-heading-anchor-permalink" href="#Optional-arguments-to-fit!-1" title="Permalink"></a></h3><p>An alternative approach is to create the <code>GeneralizedLinearMixedModel</code> object then call <code>fit!</code> on it. In this form optional arguments <code>fast</code> and/or <code>nAGQ</code> can be passed to the optimization process.</p><p>As the name implies, <code>fast=true</code>, provides a faster but somewhat less accurate fit. These fits may suffice for model comparisons.</p><pre><code class="language-julia">gm1a = fit(MixedModel, verbaggform, verbagg, Bernoulli(), fast = true)
deviance(gm1a) - deviance(gm1)
@benchmark fit(MixedModel, $verbaggform, $verbagg, Bernoulli())
@benchmark fit(MixedModel, $verbaggform, $verbagg, Bernoulli(), fast = true)</code></pre><pre><code class="language-none">BenchmarkTools.Trial: 
  memory estimate:  28.78 MiB
  allocs estimate:  2494002
  --------------
  minimum time:     445.029 ms (0.00% GC)
  median time:      463.675 ms (0.00% GC)
  mean time:        467.201 ms (1.20% GC)
  maximum time:     509.914 ms (6.80% GC)
  --------------
  samples:          11
  evals/sample:     1</code></pre><p>The optional argument <code>nAGQ=k</code> causes evaluation of the deviance function to use a <code>k</code> point adaptive Gauss-Hermite quadrature rule. This method only applies to models with a single, simple, scalar random-effects term, such as</p><pre><code class="language-julia">contraception = MixedModels.dataset(:contra)
contraform = @formula(use ~ 1 + age + abs2(age) + livch + urban + (1|dist));
bernoulli = Bernoulli()
deviances = Dict{Symbol,Float64}()
b = @benchmarkable deviances[:default] = deviance(fit(MixedModel, $contraform, $contraception, $bernoulli));
run(b)
b = @benchmarkable deviances[:fast] = deviance(fit(MixedModel, $contraform, $contraception, $bernoulli, fast = true));
run(b)
b = @benchmarkable deviances[:nAGQ] = deviance(fit(MixedModel, $contraform, $contraception, $bernoulli, nAGQ=9));
run(b)
b = @benchmarkable deviances[:nAGQ_fast] = deviance(fit(MixedModel, $contraform, $contraception, $bernoulli, nAGQ=9, fast=true));
run(b)
sort(deviances)</code></pre><pre><code class="language-none">OrderedCollections.OrderedDict{Symbol,Float64} with 4 entries:
  :default   =&gt; 2372.73
  :fast      =&gt; 2372.78
  :nAGQ      =&gt; 2372.46
  :nAGQ_fast =&gt; 2372.51</code></pre><h1 id="Extractor-functions-1"><a class="docs-heading-anchor" href="#Extractor-functions-1">Extractor functions</a><a class="docs-heading-anchor-permalink" href="#Extractor-functions-1" title="Permalink"></a></h1><p><code>LinearMixedModel</code> and <code>GeneralizedLinearMixedModel</code> are subtypes of <code>StatsBase.RegressionModel</code> which, in turn, is a subtype of <code>StatsBase.StatisticalModel</code>. Many of the generic extractors defined in the <code>StatsBase</code> package have methods for these models.</p><h2 id="Model-fit-statistics-1"><a class="docs-heading-anchor" href="#Model-fit-statistics-1">Model-fit statistics</a><a class="docs-heading-anchor-permalink" href="#Model-fit-statistics-1" title="Permalink"></a></h2><p>The statistics describing the quality of the model fit include</p><article class="docstring"><header><a class="docstring-binding" id="StatsBase.loglikelihood-Tuple{StatisticalModel}" href="#StatsBase.loglikelihood-Tuple{StatisticalModel}"><code>StatsBase.loglikelihood</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">loglikelihood(obj::StatisticalModel)</code></pre><p>Return the log-likelihood of the model.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="StatsBase.aic" href="#StatsBase.aic"><code>StatsBase.aic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">aic(obj::StatisticalModel)</code></pre><p>Akaike&#39;s Information Criterion, defined as <span>$-2 \log L + 2k$</span>, with <span>$L$</span> the likelihood of the model, and <code>k</code> its number of consumed degrees of freedom (as returned by <a href="#StatsBase.dof-Tuple{StatisticalModel}"><code>dof</code></a>).</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="StatsBase.bic" href="#StatsBase.bic"><code>StatsBase.bic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">bic(obj::StatisticalModel)</code></pre><p>Bayesian Information Criterion, defined as <span>$-2 \log L + k \log n$</span>, with <span>$L$</span> the likelihood of the model,  <span>$k$</span> its number of consumed degrees of freedom (as returned by <a href="#StatsBase.dof-Tuple{StatisticalModel}"><code>dof</code></a>), and <span>$n$</span> the number of observations (as returned by <a href="#StatsBase.nobs-Tuple{StatisticalModel}"><code>nobs</code></a>).</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="StatsBase.dof-Tuple{StatisticalModel}" href="#StatsBase.dof-Tuple{StatisticalModel}"><code>StatsBase.dof</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dof(obj::StatisticalModel)</code></pre><p>Return the number of degrees of freedom consumed in the model, including when applicable the intercept and the distribution&#39;s dispersion parameter.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="StatsBase.nobs-Tuple{StatisticalModel}" href="#StatsBase.nobs-Tuple{StatisticalModel}"><code>StatsBase.nobs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">nobs(obj::StatisticalModel)</code></pre><p>Return the number of independent observations on which the model was fitted. Be careful when using this information, as the definition of an independent observation may vary depending on the model, on the format used to pass the data, on the sampling plan (if specified), etc.</p></div></section></article><pre><code class="language-julia">loglikelihood(fm1)</code></pre><pre><code class="language-none">-163.66352994057004</code></pre><pre><code class="language-julia">aic(fm1)</code></pre><pre><code class="language-none">333.3270598811401</code></pre><pre><code class="language-julia">bic(fm1)</code></pre><pre><code class="language-none">337.5306520261266</code></pre><pre><code class="language-julia">dof(fm1)   # 1 fixed effect, 2 variances</code></pre><pre><code class="language-none">3</code></pre><pre><code class="language-julia">nobs(fm1)  # 30 observations</code></pre><pre><code class="language-none">30</code></pre><pre><code class="language-julia">loglikelihood(gm1)</code></pre><pre><code class="language-none">-4067.9164287365606</code></pre><p>In general the <a href="https://en.wikipedia.org/wiki/Deviance_(statistics)"><code>deviance</code></a> of a statistical model fit is negative twice the log-likelihood adjusting for the saturated model.</p><article class="docstring"><header><a class="docstring-binding" id="StatsBase.deviance-Tuple{StatisticalModel}" href="#StatsBase.deviance-Tuple{StatisticalModel}"><code>StatsBase.deviance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">deviance(obj::StatisticalModel)</code></pre><p>Return the deviance of the model relative to a reference, which is usually when applicable the saturated model. It is equal, <em>up to a constant</em>, to <span>$-2 \log L$</span>, with <span>$L$</span> the likelihood of the model.</p></div></section></article><p>Because it is not clear what the saturated model corresponding to a particular <code>LinearMixedModel</code> should be, negative twice the log-likelihood is called the <code>objective</code>.</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.objective" href="#MixedModels.objective"><code>MixedModels.objective</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">objective(m::LinearMixedModel)</code></pre><p>Return negative twice the log-likelihood of model <code>m</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/linearmixedmodel.jl#L557-L561">source</a></section></article><p>This value is also accessible as the <code>deviance</code> but the user should bear in mind that this doesn&#39;t have all the properties of a deviance which is corrected for the saturated model. For example, it is not necessarily non-negative.</p><pre><code class="language-julia">objective(fm1)</code></pre><pre><code class="language-none">327.3270598811401</code></pre><pre><code class="language-julia">deviance(fm1)</code></pre><pre><code class="language-none">327.3270598811401</code></pre><p>The value optimized when fitting a <code>GeneralizedLinearMixedModel</code> is the Laplace approximation to the deviance or an adaptive Gauss-Hermite evaluation.</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.deviance!" href="#MixedModels.deviance!"><code>MixedModels.deviance!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>deviance!(m::GeneralizedLinearMixedModel, nAGQ=1)</p><p>Update <code>m.η</code>, <code>m.μ</code>, etc., install the working response and working weights in <code>m.LMM</code>, update <code>m.LMM.A</code> and <code>m.LMM.R</code>, then evaluate the <a href="#StatsBase.deviance-Tuple{StatisticalModel}"><code>deviance</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/generalizedlinearmixedmodel.jl#L111-L116">source</a></section></article><pre><code class="language-julia">MixedModels.deviance!(gm1)</code></pre><pre><code class="language-none">8135.832857473123</code></pre><h2 id="Fixed-effects-parameter-estimates-1"><a class="docs-heading-anchor" href="#Fixed-effects-parameter-estimates-1">Fixed-effects parameter estimates</a><a class="docs-heading-anchor-permalink" href="#Fixed-effects-parameter-estimates-1" title="Permalink"></a></h2><p>The <code>coef</code> and <code>fixef</code> extractors both return the maximum likelihood estimates of the fixed-effects coefficients.</p><article class="docstring"><header><a class="docstring-binding" id="StatsBase.coef" href="#StatsBase.coef"><code>StatsBase.coef</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">coef(obj::StatisticalModel)</code></pre><p>Return the coefficients of the model.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="MixedModels.fixef" href="#MixedModels.fixef"><code>MixedModels.fixef</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fixef(m::MixedModel)</code></pre><p>Return the fixed-effects parameter vector estimate of <code>m</code>.</p><p>In the rank-deficient case the truncated parameter vector, of length <code>rank(m)</code> is returned. This is unlike <code>coef</code> which always returns a vector whose length matches the number of columns in <code>X</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/linearmixedmodel.jl#L394-L402">source</a></section></article><pre><code class="language-julia">coef(fm1)</code></pre><pre><code class="language-none">1-element Array{Float64,1}:
 1527.4999999999993</code></pre><pre><code class="language-julia">fixef(fm1)</code></pre><pre><code class="language-none">1-element Array{Float64,1}:
 1527.4999999999993</code></pre><p>An alternative extractor for the fixed-effects coefficient is the <code>β</code> property. Properties whose names are Greek letters usually have an alternative spelling, which is the name of the Greek letter.</p><pre><code class="language-julia">fm1.β</code></pre><pre><code class="language-none">1-element Array{Float64,1}:
 1527.4999999999993</code></pre><pre><code class="language-julia">fm1.beta</code></pre><pre><code class="language-none">1-element Array{Float64,1}:
 1527.4999999999993</code></pre><pre><code class="language-julia">gm1.β</code></pre><pre><code class="language-none">7-element Array{Float64,1}:
 -0.1531079122596256
  0.05739965082409869
  0.3207596120008002
 -1.059798143410207
 -2.103853567013612
 -1.0543587103004148
  0.7070016677683433</code></pre><p>A full list of property names is returned by <code>propertynames</code></p><pre><code class="language-julia">propertynames(fm1)</code></pre><pre><code class="language-none">(:formula, :sqrtwts, :A, :L, :optsum, :θ, :theta, :β, :beta, :λ, :lambda, :stderror, :σ, :sigma, :σs, :sigmas, :b, :u, :lowerbd, :X, :y, :corr, :vcov, :PCA, :rePCA, :reterms, :feterms, :allterms, :objective, :pvalues)</code></pre><pre><code class="language-julia">propertynames(gm1)</code></pre><pre><code class="language-none">(:A, :L, :theta, :beta, :coef, :λ, :lambda, :σ, :sigma, :X, :y, :lowerbd, :σρs, :σs, :corr, :vcov, :PCA, :rePCA, :LMM, :β, :β₀, :θ, :b, :u, :u₀, :resp, :η, :wt, :devc, :devc0, :sd, :mult)</code></pre><p>The variance-covariance matrix of the fixed-effects coefficients is returned by</p><article class="docstring"><header><a class="docstring-binding" id="StatsBase.vcov" href="#StatsBase.vcov"><code>StatsBase.vcov</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">vcov(obj::StatisticalModel)</code></pre><p>Return the variance-covariance matrix for the coefficients of the model.</p></div></section><section><div><pre><code class="language-none">vcov(m::LinearMixedModel)</code></pre><p>Returns the variance-covariance matrix of the fixed effects. If <code>corr=true</code>, then correlation of fixed effects is returned instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/mixedmodel.jl#L19-L24">source</a></section></article><pre><code class="language-julia">vcov(fm2)</code></pre><pre><code class="language-none">2×2 Array{Float64,2}:
 43.9868   -1.37039
 -1.37039   2.25671</code></pre><pre><code class="language-julia">vcov(gm1)</code></pre><pre><code class="language-none">7×7 Array{Float64,2}:
  0.148395    -0.00561483   -0.00982334   …  -0.0112075    -0.0113472
 -0.00561483   0.000280653   7.19115e-5      -1.47965e-5    1.02411e-5
 -0.00982334   7.19115e-5    0.0365599       -8.04415e-5    5.25873e-5
 -0.0167992   -1.43709e-5   -9.25609e-5       0.000265797  -0.000172095
 -0.0166232   -2.90554e-5   -0.000162388      0.000658963  -0.000520524
 -0.0112075   -1.47965e-5   -8.04415e-5   …   0.0228602    -0.000247783
 -0.0113472    1.02411e-5    5.25873e-5      -0.000247783   0.0228037</code></pre><p>The standard errors are the square roots of the diagonal elements of the estimated variance-covariance matrix of the fixed-effects coefficient estimators.</p><article class="docstring"><header><a class="docstring-binding" id="StatsBase.stderror" href="#StatsBase.stderror"><code>StatsBase.stderror</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">stderror(obj::StatisticalModel)</code></pre><p>Return the standard errors for the coefficients of the model.</p></div></section></article><pre><code class="language-julia">stderror(fm2)</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 6.632257775855945
 1.502235530969366</code></pre><pre><code class="language-julia">stderror(gm1)</code></pre><pre><code class="language-none">7-element Array{Float64,1}:
 0.3852213067776475
 0.016752705521483745
 0.1912063605043895
 0.18416054748362398
 0.18651923092389788
 0.15119586134369598
 0.1510087974420049</code></pre><p>Finally, the <code>coeftable</code> generic produces a table of coefficient estimates, their standard errors, and their ratio. The <em>p-values</em> quoted here should be regarded as approximations.</p><article class="docstring"><header><a class="docstring-binding" id="StatsBase.coeftable" href="#StatsBase.coeftable"><code>StatsBase.coeftable</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">coeftable(obj::StatisticalModel; level::Real=0.95)</code></pre><p>Return a table of class <code>CoefTable</code> with coefficients and related statistics. <code>level</code> determines the level for confidence intervals (by default, 95%).</p></div></section></article><pre><code class="language-julia">coeftable(fm2)</code></pre><pre><code class="language-none">──────────────────────────────────────────────────
                Coef.  Std. Error      z  Pr(&gt;|z|)
──────────────────────────────────────────────────
(Intercept)  251.405      6.63226  37.91    &lt;1e-99
days          10.4673     1.50224   6.97    &lt;1e-11
──────────────────────────────────────────────────</code></pre><h2 id="Covariance-parameter-estimates-1"><a class="docs-heading-anchor" href="#Covariance-parameter-estimates-1">Covariance parameter estimates</a><a class="docs-heading-anchor-permalink" href="#Covariance-parameter-estimates-1" title="Permalink"></a></h2><p>The covariance parameters estimates, in the form shown in the model summary, are a <code>VarCorr</code> object</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.VarCorr" href="#MixedModels.VarCorr"><code>MixedModels.VarCorr</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">VarCorr</code></pre><p>Information from the fitted random-effects variance-covariance matrices.</p><p><strong>Members</strong></p><ul><li><code>σρ</code>: a <code>NamedTuple</code> of <code>NamedTuple</code>s as returned from <code>σρs</code></li><li><code>s</code>: the estimate of the per-observation dispersion parameter</li></ul><p>The main purpose of defining this type is to isolate the logic in the show method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/varcorr.jl#L1-L11">source</a></section></article><pre><code class="language-julia">VarCorr(fm2)</code></pre><pre><code class="language-none">Variance components:
            Column    Variance   Std.Dev.    Corr.
subj     (Intercept)  565.510678 23.7804684
         days          32.682124  5.7168282 +0.08
Residual              654.941447 25.5918238
</code></pre><pre><code class="language-julia">VarCorr(gm1)</code></pre><pre><code class="language-none">Variance components:
        Column    Variance   Std.Dev. 
subj (Intercept)  1.79347065 1.3392052
item (Intercept)  0.11715204 0.3422748

</code></pre><p>Individual components are returned by other extractors</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.varest" href="#MixedModels.varest"><code>MixedModels.varest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">varest(m::LinearMixedModel)</code></pre><p>Returns the estimate of σ², the variance of the conditional distribution of Y given B.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/linearmixedmodel.jl#L952-L956">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MixedModels.sdest" href="#MixedModels.sdest"><code>MixedModels.sdest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sdest(m::LinearMixedModel)</code></pre><p>Return the estimate of σ, the standard deviation of the per-observation noise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/linearmixedmodel.jl#L748-L752">source</a></section></article><pre><code class="language-julia">varest(fm2)</code></pre><pre><code class="language-none">654.94144673283</code></pre><pre><code class="language-julia">sdest(fm2)</code></pre><pre><code class="language-none">25.591823825839963</code></pre><pre><code class="language-julia">fm2.σ</code></pre><pre><code class="language-none">25.591823825839963</code></pre><h2 id="Conditional-modes-of-the-random-effects-1"><a class="docs-heading-anchor" href="#Conditional-modes-of-the-random-effects-1">Conditional modes of the random effects</a><a class="docs-heading-anchor-permalink" href="#Conditional-modes-of-the-random-effects-1" title="Permalink"></a></h2><p>The <code>ranef</code> extractor</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.ranef" href="#MixedModels.ranef"><code>MixedModels.ranef</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ranef(m::LinearMixedModel; uscale=false, named=true)</code></pre><p>Return, as a <code>Vector{Vector{T}}</code> (<code>Vector{NamedVector{T}}</code> if <code>named=true</code>), the conditional modes of the random effects in model <code>m</code>.</p><p>If <code>uscale</code> is <code>true</code> the random effects are on the spherical (i.e. <code>u</code>) scale, otherwise on the original scale.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/linearmixedmodel.jl#L654-L662">source</a></section></article><pre><code class="language-julia">ranef(fm1)</code></pre><pre><code class="language-none">1-element Array{Array{Float64,2},1}:
 [-16.62822143006428 0.3695160317797815 … 53.57982460798647 -42.49434365460914]</code></pre><pre><code class="language-julia">fm1.b</code></pre><pre><code class="language-none">1-element Array{Array{Float64,2},1}:
 [-16.62822143006428 0.3695160317797815 … 53.57982460798647 -42.49434365460914]</code></pre><p>returns the <em>conditional modes</em> of the random effects given the observed data. That is, these are the values that maximize the conditional density of the random effects given the observed data. For a <code>LinearMixedModel</code> these are also the conditional mean values.</p><p>These are sometimes called the <em>best linear unbiased predictors</em> or <a href="https://en.wikipedia.org/wiki/Best_linear_unbiased_prediction"><code>BLUPs</code></a> but that name is not particularly meaningful.</p><p>At a superficial level these can be considered as the &quot;estimates&quot; of the random effects, with a bit of hand waving, but pursuing this analogy too far usually results in confusion.</p><p>The corresponding conditional variances are returned by</p><article class="docstring"><header><a class="docstring-binding" id="MixedModels.condVar" href="#MixedModels.condVar"><code>MixedModels.condVar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">condVar(m::LinearMixedModel)</code></pre><p>Return the conditional variances matrices of the random effects.</p><p>The random effects are returned by <code>ranef</code> as a vector of length <code>k</code>, where <code>k</code> is the number of random effects terms.  The <code>i</code>th element is a matrix of size <code>vᵢ × ℓᵢ</code>  where <code>vᵢ</code> is the size of the vector-valued random effects for each of the <code>ℓᵢ</code> levels of the grouping factor.  Technically those values are the modes of the conditional distribution of the random effects given the observed data.</p><p>This function returns an array of <code>k</code> three dimensional arrays, where the <code>i</code>th array is of size <code>vᵢ × vᵢ × ℓᵢ</code>.  These are the diagonal blocks from the conditional variance-covariance matrix,</p><pre><code class="language-none">s² Λ(Λ&#39;Z&#39;ZΛ + I)⁻¹Λ&#39;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/064918b5c1a8a5abb394669a6191ff9cb4237ec5/src/linearmixedmodel.jl#L213-L230">source</a></section></article><pre><code class="language-julia">condVar(fm1)</code></pre><pre><code class="language-none">1-element Array{Array{Float64,3},1}:
 [362.3104715146578]

[362.3104715146578]

[362.3104715146578]

[362.3104715146578]

[362.3104715146578]

[362.3104715146578]</code></pre><h2 id="Case-wise-diagnostics-and-residual-degrees-of-freedom-1"><a class="docs-heading-anchor" href="#Case-wise-diagnostics-and-residual-degrees-of-freedom-1">Case-wise diagnostics and residual degrees of freedom</a><a class="docs-heading-anchor-permalink" href="#Case-wise-diagnostics-and-residual-degrees-of-freedom-1" title="Permalink"></a></h2><p>The <code>leverage</code> values</p><article class="docstring"><header><a class="docstring-binding" id="StatsBase.leverage" href="#StatsBase.leverage"><code>StatsBase.leverage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">leverage(obj::RegressionModel)</code></pre><p>Return the diagonal of the projection matrix.</p></div></section></article><pre><code class="language-julia">leverage(fm1)</code></pre><pre><code class="language-none">30-element Array{Float64,1}:
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 ⋮
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486
 0.15650534392640486</code></pre><p>are used in diagnostics for linear regression models to determine cases that exert a strong influence on their own predicted response.</p><p>The documentation refers to a &quot;projection&quot;.  For a linear model without random effects the fitted values are obtained by orthogonal projection of the response onto the column span of the model matrix and the sum of the leverage values is the dimension of this column span. That is, the sum of the leverage values is the rank of the model matrix and <code>n - sum(leverage(m))</code> is the degrees of freedom for residuals. The sum of the leverage values is also the trace of the so-called &quot;hat&quot; matrix, <code>H</code>. (The name &quot;hat matrix&quot; reflects the fact that <span>$\hat{\mathbf{y}} = \mathbf{H} \mathbf{y}$</span>.  That is, <code>H</code> puts a hat on <code>y</code>.)</p><p>For a linear mixed model the sum of the leverage values will be between <code>p</code>, the rank of the fixed-effects model matrix, and <code>p + q</code> where <code>q</code> is the total number of random effects. This number does not represent a dimension (or &quot;degrees of freedom&quot;) of a linear subspace of all possible fitted values because the projection is not an orthogonal projection. Nevertheless, it is a reasonable measure of the effective degrees of freedom of the model and <code>n - sum(leverage(m))</code> can be considered the effective residual degrees of freedom.</p><p>For model <code>fm1</code> the dimensions are</p><pre><code class="language-julia">n, p, q, k = size(fm1)</code></pre><pre><code class="language-none">(30, 1, 6, 1)</code></pre><p>which implies that the sum of the leverage values should be in the range [1, 7]. The actual value is</p><pre><code class="language-julia">sum(leverage(fm1))</code></pre><pre><code class="language-none">4.695160317792145</code></pre><p>For model <code>fm2</code> the dimensions are</p><pre><code class="language-julia">n, p, q, k = size(fm2)</code></pre><pre><code class="language-none">(180, 2, 36, 1)</code></pre><p>providing a range of [2, 38] for the effective degrees of freedom for the model. The observed value is</p><pre><code class="language-julia">sum(leverage(fm2))</code></pre><pre><code class="language-none">28.61152667836093</code></pre><p>When a model converges to a singular covariance, such as</p><pre><code class="language-julia">fm3 = fit(MixedModel, @formula(yield ~ 1+(1|batch)), MixedModels.dataset(:dyestuff2))</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 yield ~ 1 + (1 | batch)
   logLik   -2 logLik     AIC        BIC    
 -81.436518 162.873037 168.873037 173.076629

Variance components:
            Column    Variance  Std.Dev. 
batch    (Intercept)   0.000000 0.0000000
Residual              13.346099 3.6532314
 Number of obs: 30; levels of grouping factors: 6

  Fixed-effects parameters:
───────────────────────────────────────────────
              Coef.  Std. Error     z  Pr(&gt;|z|)
───────────────────────────────────────────────
(Intercept)  5.6656    0.666986  8.49    &lt;1e-16
───────────────────────────────────────────────</code></pre><p>the effective degrees of freedom is the lower bound.</p><pre><code class="language-julia">sum(leverage(fm3))</code></pre><pre><code class="language-none">0.9999999999999998</code></pre><p>Models for which the estimates of the variances of the random effects are large relative to the residual variance have effective degrees of freedom close to the upper bound.</p><pre><code class="language-julia">fm4 = fit(MixedModel, @formula(diameter ~ 1+(1|plate)+(1|sample)),
    MixedModels.dataset(:penicillin))</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 diameter ~ 1 + (1 | plate) + (1 | sample)
   logLik   -2 logLik     AIC        BIC    
 -166.09417  332.18835  340.18835  352.06760

Variance components:
            Column    Variance   Std.Dev. 
plate    (Intercept)  0.71497945 0.8455646
sample   (Intercept)  3.13519425 1.7706480
Residual              0.30242640 0.5499331
 Number of obs: 144; levels of grouping factors: 24, 6

  Fixed-effects parameters:
─────────────────────────────────────────────────
               Coef.  Std. Error      z  Pr(&gt;|z|)
─────────────────────────────────────────────────
(Intercept)  22.9722    0.744596  30.85    &lt;1e-99
─────────────────────────────────────────────────</code></pre><pre><code class="language-julia">sum(leverage(fm4))</code></pre><pre><code class="language-none">27.46531786330892</code></pre><p>Also, a model fit by the REML criterion generally has larger estimates of the variance components and hence a larger effective degrees of freedom.</p><pre><code class="language-julia">fm4r = fit(MixedModel, @formula(diameter ~ 1+(1|plate)+(1|sample)),
    MixedModels.dataset(:penicillin), REML=true)</code></pre><pre><code class="language-none">Linear mixed model fit by REML
 diameter ~ 1 + (1 | plate) + (1 | sample)
 REML criterion at convergence: 330.86058899102966

Variance components:
            Column    Variance   Std.Dev.  
plate    (Intercept)  0.71690810 0.84670426
sample   (Intercept)  3.73090056 1.93155392
Residual              0.30241553 0.54992320
 Number of obs: 144; levels of grouping factors: 24, 6

  Fixed-effects parameters:
─────────────────────────────────────────────────
               Coef.  Std. Error      z  Pr(&gt;|z|)
─────────────────────────────────────────────────
(Intercept)  22.9722    0.808572  28.41    &lt;1e-99
─────────────────────────────────────────────────</code></pre><pre><code class="language-julia">sum(leverage(fm4r))</code></pre><pre><code class="language-none">27.472361443261413</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« MixedModels.jl Documentation</a><a class="docs-footer-nextpage" href="../optimization/">Details of the parameter estimation »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 15 July 2020 23:13">Wednesday 15 July 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
