<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model constructors · MixedModels</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="MixedModels logo"/></a><h1>MixedModels</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">MixedModels.jl Documentation</a></li><li class="current"><a class="toctext" href>Model constructors</a><ul class="internal"><li><a class="toctext" href="#Examples-of-linear-mixed-effects-model-fits-1">Examples of linear mixed-effects model fits</a></li><li><a class="toctext" href="#Fitting-generalized-linear-mixed-models-1">Fitting generalized linear mixed models</a></li><li class="toplevel"><a class="toctext" href="#Extractor-functions-1">Extractor functions</a></li><li><a class="toctext" href="#Model-fit-statistics-1">Model-fit statistics</a></li><li><a class="toctext" href="#Fixed-effects-parameter-estimates-1">Fixed-effects parameter estimates</a></li><li><a class="toctext" href="#Covariance-parameter-estimates-1">Covariance parameter estimates</a></li><li><a class="toctext" href="#Conditional-modes-of-the-random-effects-1">Conditional modes of the random effects</a></li></ul></li><li><a class="toctext" href="../optimization/">Details of the parameter estimation</a></li><li><a class="toctext" href="../GaussHermite/">Normalized Gauss-Hermite Quadrature</a></li><li><a class="toctext" href="../bootstrap/">Parametric bootstrap for linear mixed-effects models</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Model constructors</a></li></ul><a class="edit-page" href="https://github.com/JuliaStats/MixedModels.jl/blob/master/docs/src/constructors.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Model constructors</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Model-constructors-1" href="#Model-constructors-1">Model constructors</a></h1><p>The <code>LinearMixedModel</code> type represents a linear mixed-effects model. Typically it is constructed from a <code>Formula</code> and an appropriate <code>data</code> type, usually a <code>DataFrame</code>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.LinearMixedModel" href="#MixedModels.LinearMixedModel"><code>MixedModels.LinearMixedModel</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">LinearMixedModel</code></pre><p>Linear mixed-effects model representation</p><p><strong>Fields</strong></p><ul><li><code>formula</code>: the formula for the model</li><li><code>allterms</code>: a vector of random-effects terms, the fixed-effects terms and the response</li><li><code>sqrtwts</code>: vector of square roots of the case weights.  Can be empty.</li><li><code>A</code>: an <code>nt × nt</code> symmetric <code>BlockMatrix</code> of matrices representing <code>hcat(Z,X,y)&#39;hcat(Z,X,y)</code></li><li><code>L</code>: a <code>nt × nt</code> <code>BlockMatrix</code> - the lower Cholesky factor of <code>Λ&#39;AΛ+I</code></li><li><code>optsum</code>: an <a href="../optimization/#MixedModels.OptSummary"><code>OptSummary</code></a> object</li></ul><p><strong>Properties</strong></p><ul><li><code>θ</code> or <code>theta</code>: the covariance parameter vector used to form λ</li><li><code>β</code> or <code>beta</code>: the fixed-effects coefficient vector</li><li><code>λ</code> or <code>lambda</code>: a vector of lower triangular matrices repeated on the diagonal blocks of <code>Λ</code></li><li><code>σ</code> or <code>sigma</code>: current value of the standard deviation of the per-observation noise</li><li><code>b</code>: random effects on the original scale, as a vector of matrices</li><li><code>reterms</code>: a <code>Vector{ReMat{T}}</code> of random-effects terms.</li><li><code>feterms</code>: a <code>Vector{FeMat{T}}</code> of the fixed-effects model matrix and the response</li><li><code>u</code>: random effects on the orthogonal scale, as a vector of matrices</li><li><code>lowerbd</code>: lower bounds on the elements of θ</li><li><code>X</code>: the fixed-effects model matrix</li><li><code>y</code>: the response vector</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/linearmixedmodel.jl#L1-L28">source</a></section><h2><a class="nav-anchor" id="Examples-of-linear-mixed-effects-model-fits-1" href="#Examples-of-linear-mixed-effects-model-fits-1">Examples of linear mixed-effects model fits</a></h2><p>For illustration, several data sets from the <em>lme4</em> package for <em>R</em> are made available in <code>.rda</code> format in this package. These include the <code>Dyestuff</code> and <code>Dyestuff2</code> data sets.</p><pre><code class="language-julia">julia&gt; using DataFrames, MixedModels, RData, StatsBase

julia&gt; datf = joinpath(dirname(pathof(MixedModels)),&quot;..&quot;,&quot;test&quot;,&quot;dat.rda&quot;)
&quot;/home/travis/build/JuliaStats/MixedModels.jl/src/../test/dat.rda&quot;

julia&gt; const dat = Dict(Symbol(k)=&gt;v for (k,v) in load(datf))
Error: SystemError: opening file &quot;/home/travis/build/JuliaStats/MixedModels.jl/src/../test/dat.rda&quot;: No such file or directory

julia&gt; describe(dat[:Dyestuff])
Error: UndefVarError: dat not defined
</code></pre><p>The columns in these data sets have been renamed for convenience. The response is always named <code>Y</code>. Potential grouping factors for random-effects terms are named <code>G</code>, <code>H</code>, etc. Numeric covariates are named starting with <code>U</code>. Categorical covariates not suitable as grouping factors are named starting with <code>A</code>.</p><h3><a class="nav-anchor" id="Models-with-simple,-scalar-random-effects-1" href="#Models-with-simple,-scalar-random-effects-1">Models with simple, scalar random effects</a></h3><p>The formula language in <em>Julia</em> is similar to that in <em>R</em> except that the formula must be enclosed in a call to the <code>@formula</code> macro. A basic model with simple, scalar random effects for the levels of <code>G</code> (the batch of an intermediate product, in this case) is declared and fit as</p><pre><code class="language-julia">julia&gt; fm1 = fit!(LinearMixedModel(@formula(Y ~ 1 + (1|G)),
    dat[:Dyestuff]))
Error: UndefVarError: dat not defined
</code></pre><p>An alternative expression is</p><pre><code class="language-julia">julia&gt; fm1 = fit(MixedModel, @formula(Y ~ 1 + (1|G)), dat[:Dyestuff])
Error: UndefVarError: dat not defined
</code></pre><p>(If you are new to Julia you may find that this first fit takes an unexpectedly long time, due to Just-In-Time (JIT) compilation of the code. The second and subsequent calls to such functions are much faster.)</p><pre><code class="language-julia">julia&gt; @time fit(MixedModel, @formula(Y ~ 1 + (1|G)), dat[:Dyestuff2]);
Error: UndefVarError: dat not defined
</code></pre><p>By default, the model fit is by maximum likelihood.  To use the <code>REML</code> criterion instead, add the optional named argument <code>REML = true</code> to the call to <code>fit!</code></p><pre><code class="language-julia">julia&gt; fm1R = fit(MixedModel, @formula(Y ~ 1 + (1|G)),
    dat[:Dyestuff], REML=true)
Error: UndefVarError: dat not defined
</code></pre><h3><a class="nav-anchor" id="Simple,-scalar-random-effects-1" href="#Simple,-scalar-random-effects-1">Simple, scalar random effects</a></h3><p>A simple, scalar random effects term in a mixed-effects model formula is of the form <code>(1|G)</code>. All random effects terms end with <code>|G</code> where <code>G</code> is the <em>grouping factor</em> for the random effect. The name or, more generally, the expression <code>G</code> should evaluate to a categorical array that has a distinct set of <em>levels</em>. The random effects are associated with the levels of the grouping factor.</p><p>A <em>scalar</em> random effect is, as the name implies, one scalar value for each level of the grouping factor. A <em>simple, scalar</em> random effects term is of the form, <code>(1|G)</code>. It corresponds to a shift in the intercept for each level of the grouping factor.</p><h3><a class="nav-anchor" id="Models-with-vector-valued-random-effects-1" href="#Models-with-vector-valued-random-effects-1">Models with vector-valued random effects</a></h3><p>The <em>sleepstudy</em> data are observations of reaction time, <code>Y</code>, on several subjects, <code>G</code>, after 0 to 9 days of sleep deprivation, <code>U</code>. A model with random intercepts and random slopes for each subject, allowing for within-subject correlation of the slope and intercept, is fit as</p><pre><code class="language-julia">julia&gt; fm2 = fit(MixedModel, @formula(Y ~ 1+U + (1+U|G)), dat[:sleepstudy])
Error: UndefVarError: dat not defined
</code></pre><h3><a class="nav-anchor" id="Models-with-multiple,-scalar-random-effects-terms-1" href="#Models-with-multiple,-scalar-random-effects-terms-1">Models with multiple, scalar random-effects terms</a></h3><p>A model for the <em>Penicillin</em> data incorporates random effects for the plate, <code>G</code>, and for the sample, <code>H</code>. As every sample is used on every plate these two factors are <em>crossed</em>.</p><pre><code class="language-julia">julia&gt; fm4 = fit(MixedModel,@formula(Y ~ 1+(1|G)+(1|H)),dat[:Penicillin])
Error: UndefVarError: dat not defined
</code></pre><p>In contrast the sample, <code>G</code>, grouping factor is <em>nested</em> within the batch, <code>H</code>, grouping factor in the <em>Pastes</em> data. That is, each level of <code>G</code> occurs in conjunction with only one level of <code>H</code>.</p><pre><code class="language-julia">julia&gt; fm5 = fit(MixedModel, @formula(Y ~ 1 + (1|G) + (1|H)), dat[:Pastes])
Error: UndefVarError: dat not defined
</code></pre><p>In observational studies it is common to encounter <em>partially crossed</em> grouping factors. For example, the <em>InstEval</em> data are course evaluations by students, <code>G</code>, of instructors, <code>H</code>. Additional covariates include the academic department, <code>I</code>, in which the course was given and <code>A</code>, whether or not it was a service course.</p><pre><code class="language-julia">julia&gt; fm6 = fit(MixedModel,@formula(Y ~ 1+ A*I +(1|G)+(1|H)),dat[:InstEval])
Error: UndefVarError: dat not defined
</code></pre><h3><a class="nav-anchor" id="Simplifying-the-random-effect-correlation-structure-1" href="#Simplifying-the-random-effect-correlation-structure-1">Simplifying the random effect correlation structure</a></h3><p>MixedEffects.jl estimates not only the <em>variance</em> of the effects for each random effect level, but also the <em>correlation</em> between the random effects for different predictors. So, for the model of the <em>sleepstudy</em> data above, one of the parameters that is estimated is the correlation between each subject&#39;s random intercept (i.e., their baseline reaction time) and slope (i.e., their particular change in reaction time over days of sleep deprivation). In some cases, you may wish to simplify the random effects structure by removing these correlation parameters. This often arises when there are many random effects you want to estimate (as is common in psychological experiments with many conditions and covariates), since the number of random effects parameters increases as the square of the number of predictors, making these models difficult to estimate from limited data.</p><p>A model with uncorrelated random effects for the intercept and slope by subject is fit as</p><pre><code class="language-julia">julia&gt; fm3 = fit!(zerocorr!(LinearMixedModel(@formula(Y ~ 1+U+(1+U|G)),
    dat[:sleepstudy])))
Error: UndefVarError: dat not defined
</code></pre><p>Note that the use of <code>zerocorr!</code> requires the model to be constructed, then altered to eliminate the correlation of the random effects, then fit with a call to the mutating function, <code>fit!</code>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.zerocorr!" href="#MixedModels.zerocorr!"><code>MixedModels.zerocorr!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">zerocorr!(m::LinearMixedModel[, trmnms::Vector{Symbol}])</code></pre><p>Rewrite the random effects specification for the grouping factors in <code>trmnms</code> to zero correlation parameter.</p><p>The default for <code>trmnms</code> is all the names of random-effects terms.</p><p>A random effects term is in the zero correlation parameter configuration when the off-diagonal elements of λ are all zero - hence there are no correlation parameters in that term being estimated.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/linearmixedmodel.jl#L871-L880">source</a></section><p>The special syntax <code>zerocorr</code> can be applied to individual random effects terms inside the <code>@formula</code>:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.zerocorr" href="#MixedModels.zerocorr"><code>MixedModels.zerocorr</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">zerocorr(term::RandomEffectsTerm)</code></pre><p>Remove correlations between random effects in <code>term</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/randomeffectsterm.jl#L143-L147">source</a></section><pre><code class="language-julia">julia&gt; fit(MixedModel, @formula(Y ~ 1 + U + zerocorr(1+U|G)), dat[:sleepstudy])
Error: UndefVarError: dat not defined
</code></pre><p>Alternatively, correlations between parameters can be removed by including them as separate random effects terms:</p><pre><code class="language-julia">julia&gt; fit(MixedModel, @formula(Y ~ 1+U+(1|G)+(0+U|G)), dat[:sleepstudy])
Error: UndefVarError: dat not defined
</code></pre><p>Note that it <strong>is</strong> necessary to explicitly block the inclusion of an intercept term by adding <code>0</code> in the random-effects term <code>(0+U|G)</code>.</p><p>Finally, for predictors that are categorical, MixedModels.jl will estimate correlations between each level. Notice the large number of correlation parameters if we treat <code>U</code> as a categorical variable by giving it contrasts:</p><pre><code class="language-julia">julia&gt; fit(MixedModel, @formula(Y ~ 1+U+(1+U|G)), dat[:sleepstudy],
    contrasts=Dict(:U=&gt;DummyCoding()))
Error: UndefVarError: dat not defined
</code></pre><p>Separating the <code>1</code> and <code>U</code> random effects into separate terms removes the correlations between the intercept and the levels of <code>U</code>, but not between the levels themselves:</p><pre><code class="language-julia">julia&gt; fit(MixedModel, @formula(Y ~ 1+U+(1|G)+(0+U|G)), dat[:sleepstudy],
    contrasts=Dict(:U=&gt;DummyCoding()))
Error: UndefVarError: dat not defined
</code></pre><p>But using <code>zerocorr</code> on the individual terms (or <code>zerocorr!</code> on the constructed model object as above) does remove the correlations between the levels:</p><pre><code class="language-julia">julia&gt; fit(MixedModel, @formula(Y ~ 1+U+zerocorr(1+U|G)), dat[:sleepstudy],
    contrasts=Dict(:U=&gt;DummyCoding()))
Error: UndefVarError: dat not defined

julia&gt; fit(MixedModel, @formula(Y ~ 1+U+(1|G)+zerocorr(0+U|G)),dat[:sleepstudy],
    contrasts=Dict(:U=&gt;DummyCoding()))
Error: UndefVarError: dat not defined
</code></pre><h2><a class="nav-anchor" id="Fitting-generalized-linear-mixed-models-1" href="#Fitting-generalized-linear-mixed-models-1">Fitting generalized linear mixed models</a></h2><p>To create a GLMM representation</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.GeneralizedLinearMixedModel" href="#MixedModels.GeneralizedLinearMixedModel"><code>MixedModels.GeneralizedLinearMixedModel</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">GeneralizedLinearMixedModel</code></pre><p>Generalized linear mixed-effects model representation</p><p><strong>Fields</strong></p><ul><li><code>LMM</code>: a <a href="#MixedModels.LinearMixedModel"><code>LinearMixedModel</code></a> - the local approximation to the GLMM.</li><li><code>β</code>: the pivoted and possibly truncated fixed-effects vector</li><li><code>β₀</code>: similar to <code>β</code>. Used in the PIRLS algorithm if step-halving is needed.</li><li><code>θ</code>: covariance parameter vector</li><li><code>b</code>: similar to <code>u</code>, equivalent to <code>broadcast!(*, b, LMM.Λ, u)</code></li><li><code>u</code>: a vector of matrices of random effects</li><li><code>u₀</code>: similar to <code>u</code>.  Used in the PIRLS algorithm if step-halving is needed.</li><li><code>resp</code>: a <code>GlmResp</code> object</li><li><code>η</code>: the linear predictor</li><li><code>wt</code>: vector of prior case weights, a value of <code>T[]</code> indicates equal weights.</li></ul><p>The following fields are used in adaptive Gauss-Hermite quadrature, which applies only to models with a single random-effects term, in which case their lengths are the number of levels in the grouping factor for that term.  Otherwise they are zero-length vectors.</p><ul><li><code>devc</code>: vector of deviance components</li><li><code>devc0</code>: vector of deviance components at offset of zero</li><li><code>sd</code>: approximate standard deviation of the conditional density</li><li><code>mult</code>: multiplier</li></ul><p><strong>Properties</strong></p><p>In addition to the fieldnames, the following names are also accessible through the <code>.</code> extractor</p><ul><li><code>theta</code>: synonym for <code>θ</code></li><li><code>beta</code>: synonym for <code>β</code></li><li><code>σ</code> or <code>sigma</code>: common scale parameter (value is <code>NaN</code> for distributions without a scale parameter)</li><li><code>lowerbd</code>: vector of lower bounds on the combined elements of <code>β</code> and <code>θ</code></li><li><code>formula</code>, <code>trms</code>, <code>A</code>, <code>L</code>, and <code>optsum</code>: fields of the <code>LMM</code> field</li><li><code>X</code>: fixed-effects model matrix</li><li><code>y</code>: response vector</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/generalizedlinearmixedmodel.jl#L1-L38">source</a></section><p>the distribution family for the response, and possibly the link function, must be specified.</p><pre><code class="language-julia">julia&gt; verbaggform = @formula(r2 ~ 1+a+g+b+s+m+(1|id)+(1|item));

julia&gt; gm1 = fit(MixedModel, verbaggform, dat[:VerbAgg], Bernoulli())
Error: UndefVarError: dat not defined
</code></pre><p>The canonical link, which is <code>GLM.LogitLink</code> for the <code>Bernoulli</code> distribution, is used if no explicit link is specified.</p><p>Note that, in keeping with convention in the <a href="https://github.com/JuliaStats/GLM.jl"><code>GLM</code> package</a>, the distribution family for a binary (i.e. 0/1) response is the <code>Bernoulli</code> distribution. The <code>Binomial</code> distribution is only used when the response is the fraction of trials returning a positive, in which case the number of trials must be specified as the case weights.</p><h3><a class="nav-anchor" id="Optional-arguments-to-fit!-1" href="#Optional-arguments-to-fit!-1">Optional arguments to fit!</a></h3><p>An alternative approach is to create the <code>GeneralizedLinearMixedModel</code> object then call <code>fit!</code> on it. In this form optional arguments <code>fast</code> and/or <code>nAGQ</code> can be passed to the optimization process.</p><p>As the name implies, <code>fast=true</code>, provides a faster but somewhat less accurate fit. These fits may suffice for model comparisons.</p><pre><code class="language-julia">julia&gt; gm1a = fit!(GeneralizedLinearMixedModel(verbaggform, dat[:VerbAgg],
    Bernoulli()), fast=true)
Error: UndefVarError: dat not defined

julia&gt; deviance(gm1a) - deviance(gm1)
Error: UndefVarError: gm1a not defined

julia&gt; @time fit!(GeneralizedLinearMixedModel(verbaggform, dat[:VerbAgg],
    Bernoulli()));
Error: UndefVarError: dat not defined

julia&gt; @time fit!(GeneralizedLinearMixedModel(verbaggform, dat[:VerbAgg],
    Bernoulli()), fast=true);
Error: UndefVarError: dat not defined
</code></pre><p>The optional argument <code>nAGQ=k</code> causes evaluation of the deviance function to use a <code>k</code> point adaptive Gauss-Hermite quadrature rule. This method only applies to models with a single, simple, scalar random-effects term, such as</p><pre><code class="language-julia">julia&gt; contraform = @formula(use ~ 1+a+abs2(a)+l+urb+(1|d));

julia&gt; @time gm2 = fit!(GeneralizedLinearMixedModel(contraform,
    dat[:Contraception], Bernoulli()), nAGQ=9)
Error: UndefVarError: dat not defined

julia&gt; @time deviance(fit!(GeneralizedLinearMixedModel(contraform,
    dat[:Contraception], Bernoulli()), nAGQ=9, fast=true))
Error: UndefVarError: dat not defined

julia&gt; @time deviance(fit!(GeneralizedLinearMixedModel(contraform,
    dat[:Contraception], Bernoulli())))
Error: UndefVarError: dat not defined

julia&gt; @time deviance(fit!(GeneralizedLinearMixedModel(contraform,
    dat[:Contraception], Bernoulli()), fast=true))
Error: UndefVarError: dat not defined
</code></pre><h1><a class="nav-anchor" id="Extractor-functions-1" href="#Extractor-functions-1">Extractor functions</a></h1><p><code>LinearMixedModel</code> and <code>GeneralizedLinearMixedModel</code> are subtypes of <code>StatsBase.RegressionModel</code> which, in turn, is a subtype of <code>StatsBase.StatisticalModel</code>. Many of the generic extractors defined in the <code>StatsBase</code> package have methods for these models.</p><h2><a class="nav-anchor" id="Model-fit-statistics-1" href="#Model-fit-statistics-1">Model-fit statistics</a></h2><p>The statistics describing the quality of the model fit include</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.loglikelihood-Tuple{StatisticalModel}" href="#StatsBase.loglikelihood-Tuple{StatisticalModel}"><code>StatsBase.loglikelihood</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">loglikelihood(obj::StatisticalModel)</code></pre><p>Return the log-likelihood of the model.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.aic" href="#StatsBase.aic"><code>StatsBase.aic</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">aic(obj::StatisticalModel)</code></pre><p>Akaike&#39;s Information Criterion, defined as <span>$-2 \log L + 2k$</span>, with <span>$L$</span> the likelihood of the model, and <code>k</code> its number of consumed degrees of freedom (as returned by <a href="#StatsBase.dof-Tuple{StatisticalModel}"><code>dof</code></a>).</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.bic" href="#StatsBase.bic"><code>StatsBase.bic</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">bic(obj::StatisticalModel)</code></pre><p>Bayesian Information Criterion, defined as <span>$-2 \log L + k \log n$</span>, with <span>$L$</span> the likelihood of the model,  <span>$k$</span> its number of consumed degrees of freedom (as returned by <a href="#StatsBase.dof-Tuple{StatisticalModel}"><code>dof</code></a>), and <span>$n$</span> the number of observations (as returned by <a href="#StatsBase.nobs-Tuple{StatisticalModel}"><code>nobs</code></a>).</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.dof-Tuple{StatisticalModel}" href="#StatsBase.dof-Tuple{StatisticalModel}"><code>StatsBase.dof</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">dof(obj::StatisticalModel)</code></pre><p>Return the number of degrees of freedom consumed in the model, including when applicable the intercept and the distribution&#39;s dispersion parameter.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.nobs-Tuple{StatisticalModel}" href="#StatsBase.nobs-Tuple{StatisticalModel}"><code>StatsBase.nobs</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">nobs(obj::StatisticalModel)</code></pre><p>Return the number of independent observations on which the model was fitted. Be careful when using this information, as the definition of an independent observation may vary depending on the model, on the format used to pass the data, on the sampling plan (if specified), etc.</p></div></div></section><pre><code class="language-julia">julia&gt; loglikelihood(fm1)
Error: UndefVarError: fm1 not defined

julia&gt; aic(fm1)
Error: UndefVarError: fm1 not defined

julia&gt; bic(fm1)
Error: UndefVarError: fm1 not defined

julia&gt; dof(fm1)   # 1 fixed effect, 2 variances
Error: UndefVarError: fm1 not defined

julia&gt; nobs(fm1)  # 30 observations
Error: UndefVarError: fm1 not defined

julia&gt; loglikelihood(gm1)
Error: UndefVarError: gm1 not defined
</code></pre><p>In general the <a href="https://en.wikipedia.org/wiki/Deviance_(statistics)"><code>deviance</code></a> of a statistical model fit is negative twice the log-likelihood adjusting for the saturated model.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.deviance-Tuple{StatisticalModel}" href="#StatsBase.deviance-Tuple{StatisticalModel}"><code>StatsBase.deviance</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">deviance(obj::StatisticalModel)</code></pre><p>Return the deviance of the model relative to a reference, which is usually when applicable the saturated model. It is equal, <em>up to a constant</em>, to <span>$-2 \log L$</span>, with <span>$L$</span> the likelihood of the model.</p></div></div></section><p>Because it is not clear what the saturated model corresponding to a particular <code>LinearMixedModel</code> should be, negative twice the log-likelihood is called the <code>objective</code>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.objective" href="#MixedModels.objective"><code>MixedModels.objective</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">objective(m::LinearMixedModel)</code></pre><p>Return negative twice the log-likelihood of model <code>m</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/linearmixedmodel.jl#L524-L528">source</a></section><p>This value is also accessible as the <code>deviance</code> but the user should bear in mind that this doesn&#39;t have all the properties of a deviance which is corrected for the saturated model. For example, it is not necessarily non-negative.</p><pre><code class="language-julia">julia&gt; objective(fm1)
Error: UndefVarError: fm1 not defined

julia&gt; deviance(fm1)
Error: UndefVarError: fm1 not defined
</code></pre><p>The value optimized when fitting a <code>GeneralizedLinearMixedModel</code> is the Laplace approximation to the deviance or an adaptive Gauss-Hermite evaluation.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.deviance!" href="#MixedModels.deviance!"><code>MixedModels.deviance!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>deviance!(m::GeneralizedLinearMixedModel, nAGQ=1)</p><p>Update <code>m.η</code>, <code>m.μ</code>, etc., install the working response and working weights in <code>m.LMM</code>, update <code>m.LMM.A</code> and <code>m.LMM.R</code>, then evaluate the <a href="#StatsBase.deviance-Tuple{StatisticalModel}"><code>deviance</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/generalizedlinearmixedmodel.jl#L98-L103">source</a></section><pre><code class="language-julia">julia&gt; MixedModels.deviance!(gm1)
Error: UndefVarError: gm1 not defined
</code></pre><h2><a class="nav-anchor" id="Fixed-effects-parameter-estimates-1" href="#Fixed-effects-parameter-estimates-1">Fixed-effects parameter estimates</a></h2><p>The <code>coef</code> and <code>fixef</code> extractors both return the maximum likelihood estimates of the fixed-effects coefficients.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.coef" href="#StatsBase.coef"><code>StatsBase.coef</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">coef(obj::StatisticalModel)</code></pre><p>Return the coefficients of the model.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.fixef" href="#MixedModels.fixef"><code>MixedModels.fixef</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">fixef(m::MixedModel, permuted=true)</code></pre><p>Return the fixed-effects parameter vector estimate of <code>m</code>.</p><p>If <code>permuted</code> is <code>true</code> the vector elements are permuted according to <code>first(m.feterms).piv</code> and truncated to the rank of that term.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/linearmixedmodel.jl#L363-L370">source</a></section><pre><code class="language-julia">julia&gt; show(coef(fm1))
Error: UndefVarError: fm1 not defined

julia&gt; show(fixef(fm1))
Error: UndefVarError: fm1 not defined

julia&gt; show(fixef(gm1))
Error: UndefVarError: gm1 not defined
</code></pre><p>An alternative extractor for the fixed-effects coefficient is the <code>β</code> property. Properties whose names are Greek letters usually have an alternative spelling, which is the name of the Greek letter.</p><pre><code class="language-julia">julia&gt; show(fm1.β)
Error: UndefVarError: fm1 not defined

julia&gt; show(fm1.beta)
Error: UndefVarError: fm1 not defined

julia&gt; show(gm1.β)
Error: UndefVarError: gm1 not defined
</code></pre><p>A full list of property names is returned by <code>propertynames</code></p><pre><code class="language-julia">julia&gt; propertynames(fm1)
Error: UndefVarError: fm1 not defined

julia&gt; propertynames(gm1)
Error: UndefVarError: gm1 not defined
</code></pre><p>The variance-covariance matrix of the fixed-effects coefficients is returned by</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.vcov" href="#StatsBase.vcov"><code>StatsBase.vcov</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">vcov(obj::StatisticalModel)</code></pre><p>Return the variance-covariance matrix for the coefficients of the model.</p></div></div></section><pre><code class="language-julia">julia&gt; vcov(fm2)
Error: UndefVarError: fm2 not defined

julia&gt; vcov(gm1)
Error: UndefVarError: gm1 not defined
</code></pre><p>The standard errors are the square roots of the diagonal elements of the estimated variance-covariance matrix of the fixed-effects coefficient estimators.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.stderror" href="#StatsBase.stderror"><code>StatsBase.stderror</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">stderror(obj::StatisticalModel)</code></pre><p>Return the standard errors for the coefficients of the model.</p></div></div></section><pre><code class="language-julia">julia&gt; show(StatsBase.stderror(fm2))
Error: UndefVarError: fm2 not defined

julia&gt; show(StatsBase.stderror(gm1))
Error: UndefVarError: gm1 not defined
</code></pre><p>Finally, the <code>coeftable</code> generic produces a table of coefficient estimates, their standard errors, and their ratio. The <em>p-values</em> quoted here should be regarded as approximations.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.coeftable" href="#StatsBase.coeftable"><code>StatsBase.coeftable</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">coeftable(obj::StatisticalModel; level::Real=0.95)</code></pre><p>Return a table of class <code>CoefTable</code> with coefficients and related statistics. <code>level</code> determines the level for confidence intervals (by default, 95%).</p></div></div></section><pre><code class="language-julia">julia&gt; coeftable(fm2)
Error: UndefVarError: fm2 not defined
</code></pre><h2><a class="nav-anchor" id="Covariance-parameter-estimates-1" href="#Covariance-parameter-estimates-1">Covariance parameter estimates</a></h2><p>The covariance parameters estimates, in the form shown in the model summary, are a <code>VarCorr</code> object</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.VarCorr" href="#MixedModels.VarCorr"><code>MixedModels.VarCorr</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">VarCorr</code></pre><p>Information from the fitted random-effects variance-covariance matrices.</p><p><strong>Members</strong></p><ul><li><code>σρ</code>: a <code>NamedTuple</code> of <code>NamedTuple</code>s as returned from <code>σρs</code></li><li><code>s</code>: the estimate of the per-observation dispersion parameter</li></ul><p>The main purpose of defining this type is to isolate the logic in the show method.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/varcorr.jl#L1-L11">source</a></section><pre><code class="language-julia">julia&gt; VarCorr(fm2)
Error: UndefVarError: fm2 not defined

julia&gt; VarCorr(gm1)
Error: UndefVarError: gm1 not defined
</code></pre><p>Individual components are returned by other extractors</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.varest" href="#MixedModels.varest"><code>MixedModels.varest</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">varest(m::LinearMixedModel)</code></pre><p>Returns the estimate of σ², the variance of the conditional distribution of Y given B.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/linearmixedmodel.jl#L846-L850">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.sdest" href="#MixedModels.sdest"><code>MixedModels.sdest</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">sdest(m::LinearMixedModel)</code></pre><p>Return the estimate of σ, the standard deviation of the per-observation noise.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/linearmixedmodel.jl#L690-L694">source</a></section><pre><code class="language-julia">julia&gt; varest(fm2)
Error: UndefVarError: fm2 not defined

julia&gt; sdest(fm2)
Error: UndefVarError: fm2 not defined

julia&gt; fm2.σ
Error: UndefVarError: fm2 not defined
</code></pre><h2><a class="nav-anchor" id="Conditional-modes-of-the-random-effects-1" href="#Conditional-modes-of-the-random-effects-1">Conditional modes of the random effects</a></h2><p>The <code>ranef</code> extractor</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.ranef" href="#MixedModels.ranef"><code>MixedModels.ranef</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">ranef(m::LinearMixedModel; uscale=false, named=true)</code></pre><p>Return, as a <code>Vector{Vector{T}}</code> (<code>Vector{NamedVector{T}}</code> if <code>named=true</code>), the conditional modes of the random effects in model <code>m</code>.</p><p>If <code>uscale</code> is <code>true</code> the random effects are on the spherical (i.e. <code>u</code>) scale, otherwise on the original scale.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/linearmixedmodel.jl#L616-L624">source</a></section><pre><code class="language-julia">julia&gt; ranef(fm1)
Error: UndefVarError: fm1 not defined

julia&gt; fm1.b
Error: UndefVarError: fm1 not defined
</code></pre><p>returns the <em>conditional modes</em> of the random effects given the observed data. That is, these are the values that maximize the conditional density of the random effects given the observed data. For a <code>LinearMixedModel</code> these are also the conditional mean values.</p><p>These are sometimes called the <em>best linear unbiased predictors</em> or <a href="https://en.wikipedia.org/wiki/Best_linear_unbiased_prediction"><code>BLUPs</code></a> but that name is not particularly meaningful.</p><p>At a superficial level these can be considered as the &quot;estimates&quot; of the random effects, with a bit of hand waving, but pursuing this analogy too far usually results in confusion.</p><p>The corresponding conditional variances are returned by</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.condVar" href="#MixedModels.condVar"><code>MixedModels.condVar</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">condVar(m::LinearMixedModel)</code></pre><p>Return the conditional variances matrices of the random effects.</p><p>The random effects are returned by <code>ranef</code> as a vector of length <code>k</code>, where <code>k</code> is the number of random effects terms.  The <code>i</code>th element is a matrix of size <code>vᵢ × ℓᵢ</code>  where <code>vᵢ</code> is the size of the vector-valued random effects for each of the <code>ℓᵢ</code> levels of the grouping factor.  Technically those values are the modes of the conditional distribution of the random effects given the observed data.</p><p>This function returns an array of <code>k</code> three dimensional arrays, where the <code>i</code>th array is of size <code>vᵢ × vᵢ × ℓᵢ</code>.  These are the diagonal blocks from the conditional variance-covariance matrix,</p><pre><code class="language-none">s² Λ(Λ&#39;Z&#39;ZΛ + I)⁻¹Λ&#39;</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/4845f6b7cdb80d14f443de1b9b23dc7fc9f13317/src/linearmixedmodel.jl#L190-L207">source</a></section><pre><code class="language-julia">julia&gt; condVar(fm1)
Error: UndefVarError: fm1 not defined
</code></pre><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">MixedModels.jl Documentation</span></a><a class="next" href="../optimization/"><span class="direction">Next</span><span class="title">Details of the parameter estimation</span></a></footer></article></body></html>
