<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parametric bootstrap for linear mixed-effects models · MixedModels</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="MixedModels logo"/></a><h1>MixedModels</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">MixedModels.jl Documentation</a></li><li><a class="toctext" href="../constructors/">Model constructors</a></li><li><a class="toctext" href="../optimization/">Details of the parameter estimation</a></li><li><a class="toctext" href="../GaussHermite/">Normalized Gauss-Hermite Quadrature</a></li><li class="current"><a class="toctext" href>Parametric bootstrap for linear mixed-effects models</a><ul class="internal"><li><a class="toctext" href="#The-parametric-bootstrap-1">The parametric bootstrap</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Parametric bootstrap for linear mixed-effects models</a></li></ul><a class="edit-page" href="https://github.com/JuliaStats/MixedModels.jl/blob/master/docs/src/bootstrap.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Parametric bootstrap for linear mixed-effects models</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Parametric-bootstrap-for-linear-mixed-effects-models-1" href="#Parametric-bootstrap-for-linear-mixed-effects-models-1">Parametric bootstrap for linear mixed-effects models</a></h1><p>Julia is well-suited to implementing bootstrapping and other simulation-based methods for statistical models. The <code>parametricbootstrap</code> function in the <a href="https://github.com/JuliaStats/MixedModels.jl">MixedModels package</a> provides an efficient parametric bootstrap for linear mixed-effects models.</p><h2><a class="nav-anchor" id="The-parametric-bootstrap-1" href="#The-parametric-bootstrap-1">The parametric bootstrap</a></h2><p><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">Bootstrapping</a> is a family of procedures for generating sample values of a statistic, allowing for visualization of the distribution of the statistic or for inference from this sample of values.</p><p>A <em>parametric bootstrap</em> is used with a parametric model, <code>m</code>, that has been fit to data. The procedure is to simulate <code>n</code> response vectors from <code>m</code> using the estimated parameter values and refit <code>m</code> to these responses in turn, accumulating the statistics of interest at each iteration.</p><p>The parameters of a <code>LinearMixedModel</code> object are the fixed-effects parameters, <code>β</code>, the standard deviation, <code>σ</code>, of the per-observation noise, and the covariance parameter, <code>θ</code>, that defines the variance-covariance matrices of the random effects.</p><p>For example, a simple linear mixed-effects model for the <code>Dyestuff</code> data in the <a href="http://github.com/lme4/lme4"><code>lme4</code></a> package for <a href="https://www.r-project.org"><code>R</code></a> is fit by</p><pre><code class="language-julia">using DataFrames, Gadfly, MixedModels, Random, RData
testdir = normpath(joinpath(dirname(pathof(MixedModels)), &quot;..&quot;, &quot;test&quot;));
const dat = Dict(Symbol(k)=&gt;v for (k,v) in load(joinpath(testdir, &quot;dat.rda&quot;)));</code></pre><pre><code class="language-julia">ds = names!(dat[:Dyestuff], [:Batch, :Yield])  # the Dyestuff data
m1 = fit(MixedModel, @formula(Yield ~ 1 + (1 | Batch)), ds)</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 Yield ~ 1 + (1 | Batch)
   logLik   -2 logLik     AIC        BIC    
 -163.66353  327.32706  333.32706  337.53065

Variance components:
            Column    Variance  Std.Dev. 
Batch    (Intercept)  1388.3333 37.260345
Residual              2451.2500 49.510100
 Number of obs: 30; levels of grouping factors: 6

  Fixed-effects parameters:
──────────────────────────────────────────────────
             Estimate  Std.Error  z value  P(&gt;|z|)
──────────────────────────────────────────────────
(Intercept)    1527.5    17.6946   86.326   &lt;1e-99
──────────────────────────────────────────────────</code></pre><p>To bootstrap the model parameters, first initialize a random number generator</p><pre><code class="language-julia">rng = MersenneTwister(1234321);</code></pre><p>then create a bootstrap sample</p><pre><code class="language-julia">samp = parametricbootstrap(rng, 10_000, m1);
propertynames(samp)</code></pre><pre><code class="language-none">7-element Array{Symbol,1}:
 :model               
 :objective           
 :σ                   
 :θ                   
 :σs                  
 :σρs                 
 Symbol(&quot;(Intercept)&quot;)</code></pre><p>As shown above, the sample has several named properties, which allow for convenient extraction of information.  For example, a density plot of the estimates of <code>σ</code>, the residual standard deviation, can be created as</p><pre><code class="language-julia">plot(x=samp.σ, Geom.density, Guide.xlabel(&quot;Parametric bootstrap estimates of σ&quot;))</code></pre><p><img src="../assets/bootstrap_sigmadensity_1.svg" alt/></p><p>For the estimates of the intercept parameter, the <code>getproperty</code> extractor must be used</p><pre><code class="language-julia">plot(x = getproperty(samp, Symbol(&quot;(Intercept)&quot;)), Geom.density,
    Guide.xlabel(&quot;Parametric bootstrap estimates of β₁&quot;))</code></pre><p><img src="../assets/bootstrap_betadensity_1.svg" alt/></p><p>The <code>σs</code> property contains the estimates of the standard deviation of the random effects in a hierarchical format.</p><pre><code class="language-julia">typeof(samp.σs)</code></pre><pre><code class="language-none">NamedTuple{(:Batch,),Tuple{Array{NamedTuple{(Symbol(&quot;(Intercept)&quot;),),Tuple{
Float64}},1}}}</code></pre><p>This is to allow for random effects associated with more than one grouping factor. If we only have one grouping factor for random effects, which is the case here, we can use the <code>first</code> extractor, as in</p><pre><code class="language-julia">first(samp.σs)</code></pre><pre><code class="language-none">10000-element Array{NamedTuple{(Symbol(&quot;(Intercept)&quot;),),Tuple{Float64}},1}:
 ((Intercept) = 14.31202440021031,) 
 ((Intercept) = 25.567322049075496,)
 ((Intercept) = 21.76223553106598,) 
 ((Intercept) = 41.05589492574884,) 
 ((Intercept) = 19.18021885057642,) 
 ((Intercept) = 49.18319132233348,) 
 ((Intercept) = 46.711965099114124,)
 ((Intercept) = 37.636680075523266,)
 ((Intercept) = 15.125683728901562,)
 ((Intercept) = 0.0,)               
 ⋮                                  
 ((Intercept) = 0.0,)               
 ((Intercept) = 35.47993724363591,) 
 ((Intercept) = 85.6889420619044,)  
 ((Intercept) = 52.453848318538654,)
 ((Intercept) = 13.977380127035849,)
 ((Intercept) = 56.19821452821661,) 
 ((Intercept) = 17.3300825173626,)  
 ((Intercept) = 23.634457239496463,)
 ((Intercept) = 23.999614688511368,)</code></pre><p>or, to carry this one step further,</p><pre><code class="language-julia">plot(x=first.(first(samp.σs)), Geom.density,
    Guide.xlabel(&quot;Parametric bootstrap estimates of σ₁&quot;))</code></pre><p><img src="../assets/bootstrap_sigma1density_1.svg" alt/></p><p>Notice that this density plot has a spike, or mode, at zero. Although this mode appears to be diffuse, this is an artifact of the way that density plots are created. In fact, it is a pulse, as can be seen from a histogram.</p><pre><code class="language-julia">plot(x=first.(first(samp.σs)), Geom.histogram,
    Guide.xlabel(&quot;Parametric bootstrap estimates of σ₁&quot;))</code></pre><p><img src="../assets/bootstrap_sigma1histogram_1.svg" alt/></p><footer><hr/><a class="previous" href="../GaussHermite/"><span class="direction">Previous</span><span class="title">Normalized Gauss-Hermite Quadrature</span></a></footer></article></body></html>
