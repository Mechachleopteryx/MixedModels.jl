<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parametric bootstrap for linear mixed-effects models · MixedModels</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="MixedModels logo"/></a><h1>MixedModels</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">MixedModels.jl Documentation</a></li><li><a class="toctext" href="../constructors/">Model constructors</a></li><li><a class="toctext" href="../optimization/">Details of the parameter estimation</a></li><li><a class="toctext" href="../GaussHermite/">Normalized Gauss-Hermite Quadrature</a></li><li class="current"><a class="toctext" href>Parametric bootstrap for linear mixed-effects models</a><ul class="internal"><li><a class="toctext" href="#The-parametric-bootstrap-1">The parametric bootstrap</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Parametric bootstrap for linear mixed-effects models</a></li></ul><a class="edit-page" href="https://github.com/JuliaStats/MixedModels.jl/blob/master/docs/src/bootstrap.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Parametric bootstrap for linear mixed-effects models</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Parametric-bootstrap-for-linear-mixed-effects-models-1" href="#Parametric-bootstrap-for-linear-mixed-effects-models-1">Parametric bootstrap for linear mixed-effects models</a></h1><p>Julia is well-suited to implementing bootstrapping and other simulation-based methods for statistical models. The <code>parametricbootstrap</code> function in the <a href="https://github.com/JuliaStats/MixedModels.jl">MixedModels package</a> provides an efficient parametric bootstrap for linear mixed-effects models.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MixedModels.parametricbootstrap" href="#MixedModels.parametricbootstrap"><code>MixedModels.parametricbootstrap</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">parametricbootstrap(rng::AbstractRNG, nsamp::Integer, m::LinearMixedModel;
    β = m.β, σ = m.σ, θ = m.θ)
parametricbootstrap(nsamp::Integer, m::LinearMixedModel;
    β = m.β, σ = m.σ, θ = m.θ)</code></pre><p>Perform <code>nsamp</code> parametric bootstrap replication fits of <code>m</code>, returning a <code>MixedModelBootstrap</code>.</p><p>The default random number generator is <code>Random.GLOBAL_RNG</code>.</p><p><strong>Named Arguments</strong></p><p><code>β</code>, <code>σ</code>, and <code>θ</code> are the values of <code>m</code>&#39;s parameters for simulating the responses.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/be67f5ca1fa1a3832f163563e488c2429112211c/src/simulate.jl#L43-L56">source</a></section><h2><a class="nav-anchor" id="The-parametric-bootstrap-1" href="#The-parametric-bootstrap-1">The parametric bootstrap</a></h2><p><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">Bootstrapping</a> is a family of procedures for generating sample values of a statistic, allowing for visualization of the distribution of the statistic or for inference from this sample of values.</p><p>A <em>parametric bootstrap</em> is used with a parametric model, <code>m</code>, that has been fit to data. The procedure is to simulate <code>n</code> response vectors from <code>m</code> using the estimated parameter values and refit <code>m</code> to these responses in turn, accumulating the statistics of interest at each iteration.</p><p>The parameters of a <code>LinearMixedModel</code> object are the fixed-effects parameters, <code>β</code>, the standard deviation, <code>σ</code>, of the per-observation noise, and the covariance parameter, <code>θ</code>, that defines the variance-covariance matrices of the random effects.</p><p>For example, a simple linear mixed-effects model for the <code>Dyestuff</code> data in the <a href="http://github.com/lme4/lme4"><code>lme4</code></a> package for <a href="https://www.r-project.org"><code>R</code></a> is fit by</p><pre><code class="language-julia">julia&gt; using DataFrames, Gadfly, MixedModels, Random, RData

julia&gt; datf = joinpath(dirname(pathof(MixedModels)), &quot;..&quot;, &quot;test&quot;, &quot;dat.rda&quot;);

julia&gt; const dat = Dict(Symbol(k)=&gt;v for (k,v) in load(datf));
Error: SystemError: opening file &quot;/home/travis/build/JuliaStats/MixedModels.jl/src/../test/dat.rda&quot;: No such file or directory
</code></pre><pre><code class="language-julia">julia&gt; ds = rename!(dat[:Dyestuff], [:Batch, :Yield])  # the Dyestuff data
Error: UndefVarError: dat not defined

julia&gt; m1 = fit(MixedModel, @formula(Yield ~ 1 + (1 | Batch)), ds)
Error: UndefVarError: ds not defined
</code></pre><p>To bootstrap the model parameters, first initialize a random number generator</p><pre><code class="language-julia">julia&gt; const rng = MersenneTwister(1234321);
</code></pre><p>then create a bootstrap sample</p><pre><code class="language-julia">julia&gt; samp = parametricbootstrap(rng, 10_000, m1);
Error: UndefVarError: m1 not defined

julia&gt; propertynames(samp)
Error: UndefVarError: samp not defined
</code></pre><p>As shown above, the sample has several named properties, which allow for convenient extraction of information.  For example, a density plot of the estimates of <code>σ</code>, the residual standard deviation, can be created as</p><pre><code class="language-julia">plot(x=samp.σ, Geom.density, Guide.xlabel(&quot;Parametric bootstrap estimates of σ&quot;))</code></pre><pre><code class="language-none">Error: UndefVarError: samp not defined</code></pre><p>For the estimates of the intercept parameter, the <code>getproperty</code> extractor must be used</p><pre><code class="language-julia">plot(x = first.(samp.β), Geom.density, Guide.xlabel(&quot;Parametric bootstrap estimates of β₁&quot;))</code></pre><pre><code class="language-none">Error: UndefVarError: samp not defined</code></pre><p>The <code>σs</code> property contains the estimates of the standard deviation of the random effects in a hierarchical format.</p><pre><code class="language-julia">julia&gt; typeof(samp.σs)
Error: UndefVarError: samp not defined
</code></pre><p>This is to allow for random effects associated with more than one grouping factor. If we only have one grouping factor for random effects, which is the case here, we can use the <code>first</code> extractor, as in</p><pre><code class="language-julia">julia&gt; first(samp.σs)
Error: UndefVarError: samp not defined
</code></pre><p>or, to carry this one step further,</p><pre><code class="language-julia">plot(x=first.(first(samp.σs)), Geom.density,
    Guide.xlabel(&quot;Parametric bootstrap estimates of σ₁&quot;))</code></pre><pre><code class="language-none">Error: UndefVarError: samp not defined</code></pre><p>Notice that this density plot has a spike, or mode, at zero. Although this mode appears to be diffuse, this is an artifact of the way that density plots are created. In fact, it is a pulse, as can be seen from a histogram.</p><pre><code class="language-julia">plot(x=first.(first(samp.σs)), Geom.histogram,
    Guide.xlabel(&quot;Parametric bootstrap estimates of σ₁&quot;))</code></pre><pre><code class="language-none">Error: UndefVarError: samp not defined</code></pre><p>A value of zero for the standard deviation of the random effects is an example of a <em>singular</em> covariance. It is easy to detect the singularity in the case of a scalar random-effects term. However, it is not as straightforward to detect singularity in vector-valued random-effects terms.</p><p>For example, if we bootstrap a model fit to the <code>sleepstudy</code> data</p><pre><code class="language-julia">julia&gt; m2 = fit(MixedModel, @formula(Y ~ 1+U+(1+U|G)), dat[:sleepstudy])
Error: UndefVarError: dat not defined
</code></pre><pre><code class="language-julia">julia&gt; samp2 = parametricbootstrap(rng, 10_000, m2);
Error: UndefVarError: m2 not defined
</code></pre><p>the singularity can be exhibited as a standard deviation of zero or as a correlation of <span>$\pm1$</span>. The <code>σρs</code> property of the sample is a vector of named tuples</p><pre><code class="language-julia">julia&gt; σρ = first(samp2.σρs);
Error: UndefVarError: samp2 not defined

julia&gt; typeof(σρ)
Error: UndefVarError: σρ not defined
</code></pre><p>where the first element of the tuple is itself a tuple of standard deviations and the second (also the last) element of the tuple is the correlation.</p><p>A histogram of the estimated correlations from the bootstrap sample has a spike at <code>+1</code>.</p><pre><code class="language-julia">ρs = first.(last.(σρ))</code></pre><pre><code class="language-none">Error: UndefVarError: σρ not defined</code></pre><pre><code class="language-julia">plot(x = ρs, Geom.histogram,
    Guide.xlabel(&quot;Parametric bootstrap samples of correlation of random effects&quot;))</code></pre><pre><code class="language-none">Error: UndefVarError: ρs not defined</code></pre><p>or, as a count,</p><pre><code class="language-julia">julia&gt; sum(ρs .≈ 1)
Error: UndefVarError: ρs not defined
</code></pre><p>Close examination of the histogram shows a few values of <code>-1</code>.</p><pre><code class="language-julia">julia&gt; sum(ρs .≈ -1)
Error: UndefVarError: ρs not defined
</code></pre><p>Furthermore there are even a few cases where the estimate of the standard deviation of the random effect for the intercept is zero.</p><pre><code class="language-julia">julia&gt; sum(first.(first.(first.(σρ))) .≈ 0)
Error: UndefVarError: σρ not defined
</code></pre><p>There is a general condition to check for singularity of an estimated covariance matrix or matrices in a bootstrap sample. The parameter optimized in the estimation is <code>θ</code>, the relative covariance parameter. Some of the elements of this parameter vector must be non-negative and, when one of these components is approximately zero, one of the covariance matrices will be singular.</p><p>The boundary values are available as</p><pre><code class="language-julia">julia&gt; samp2.m.optsum.lowerbd
Error: UndefVarError: samp2 not defined
</code></pre><p>so the check on singularity becomes</p><pre><code class="language-julia">julia&gt; sum(θ -&gt; any(θ .≈ samp2.m.optsum.lowerbd), samp2.θ)
Error: UndefVarError: samp2 not defined
</code></pre><p>The <code>issingular</code> method for a <code>LinearMixedModel</code> object that tests if a parameter vector <code>θ</code> corresponds to a boundary or singular fit. The default value of <code>θ</code> is that from the model but another value can be given as the second argument.</p><p>This operation is encapsulated in a method for the <code>issingular</code> function.</p><pre><code class="language-julia">julia&gt; sum(issingular(samp2))
Error: UndefVarError: samp2 not defined
</code></pre><footer><hr/><a class="previous" href="../GaussHermite/"><span class="direction">Previous</span><span class="title">Normalized Gauss-Hermite Quadrature</span></a></footer></article></body></html>
